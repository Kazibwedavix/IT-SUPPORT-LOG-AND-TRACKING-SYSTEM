<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    
    <!-- Primary Meta Tags -->
    <title>IT Support System | Enterprise IT Support & Ticketing</title>
    <meta name="title" content="IT Support System | Enterprise IT Support & Ticketing">
    <meta name="description" content="Enterprise-grade IT support ticketing system for managing help desk requests, incidents, and IT service management">
    <meta name="keywords" content="IT Support, Help Desk, Ticketing System, ITSM, Service Desk, IT Management">
    <meta name="author" content="IT Support System">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://support.yourcompany.com/">
    <meta property="og:title" content="IT Support System | Enterprise IT Support & Ticketing">
    <meta property="og:description" content="Enterprise-grade IT support ticketing system for managing help desk requests, incidents, and IT service management">
    <meta property="og:image" content="%PUBLIC_URL%/og-image.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://support.yourcompany.com/">
    <meta property="twitter:title" content="IT Support System | Enterprise IT Support & Ticketing">
    <meta property="twitter:description" content="Enterprise-grade IT support ticketing system for managing help desk requests, incidents, and IT service management">
    <meta property="twitter:image" content="%PUBLIC_URL%/twitter-image.png">
    
    <!-- PWA & Mobile Configuration -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="IT Support">
    <meta name="application-name" content="IT Support System">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2563eb">
    <meta name="msapplication-TileColor" content="#2563eb">
    <meta name="msapplication-config" content="%PUBLIC_URL%/browserconfig.xml">
    
    <!-- Security Headers - UPDATED TO ALLOW BOTH PORTS AND EXTERNAL RESOURCES -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://polyfill.io https://cdnjs.cloudflare.com https://www.googletagmanager.com;
      style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
      font-src 'self' data: https://fonts.gstatic.com;
      img-src 'self' data: blob: https:;
      connect-src 'self' http://localhost:5001 http://localhost:5002 ws://localhost:5001 ws://localhost:5002;
      frame-src 'none';
      object-src 'none';
    ">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <!-- REMOVED X-Frame-Options as it cannot be set via meta tag -->
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), payment=()">
    
    <!-- Icons & Manifest -->
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="%PUBLIC_URL%/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="%PUBLIC_URL%/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="%PUBLIC_URL%/apple-touch-icon.png">
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" crossorigin="use-credentials">
    
    <!-- Preload Critical Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" media="print" onload="this.media='all'">
    
    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    
    <!-- Preload Critical Assets -->
    <link rel="preload" as="image" href="%PUBLIC_URL%/logo.svg" type="image/svg+xml">
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "IT Support System",
      "description": "Enterprise IT support ticketing system",
      "url": "https://support.yourcompany.com",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Organization",
        "name": "IT Support System"
      }
    }
    </script>
    
    <!-- Environment Variables for JavaScript - UPDATED API URL -->
    <script>
      // Set global configuration
      window.ENV = {
        REACT_APP_API_URL: 'http://localhost:5002/api',
        REACT_APP_ENABLE_DEBUG: true, // Changed to true for development
        REACT_APP_VERSION: '1.0.0',
        REACT_APP_BUILD_TIMESTAMP: '<%= new Date().toISOString() %>'
      };
      
      // Performance monitoring
      window.__PERFORMANCE_MONITORING__ = {
        enabled: true,
        sampleRate: 0.1
      };
      
      // Error tracking initialization
      window.__ERROR_TRACKING__ = {
        enabled: true,
        dsn: '', // Add your error tracking DSN here
        environment: 'development'
      };
    </script>
    
    <!-- Critical CSS (extract from your main CSS file) -->
    <style id="critical-css">
      /* Critical path CSS for above-the-fold content */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      html, body {
        height: 100%;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
          'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
          sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        overflow-x: hidden;
      }
      
      #root {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      
      /* Loading state */
      .app-loading {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }
      
      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 5px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: white;
        animation: spin 1s ease-in-out infinite;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      
      /* Print styles */
      @media print {
        .no-print {
          display: none !important;
        }
      }
    </style>
    
    <!-- Non-critical CSS (loaded asynchronously) -->
    <link rel="stylesheet" href="%PUBLIC_URL%/static/css/non-critical.css" media="print" onload="this.media='all'">
    
    <!-- Preload Scripts -->
    <link rel="preload" as="script" href="%PUBLIC_URL%/static/js/runtime-main.js">
    <link rel="preload" as="script" href="%PUBLIC_URL%/static/js/main.chunk.js">
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
      <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-XXXXXXX"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <!-- Progressive Enhancement: Content without JavaScript -->
    <noscript>
      <div class="noscript-warning">
        <div class="noscript-content">
          <h1>JavaScript Required</h1>
          <p>This application requires JavaScript to function properly. Please enable JavaScript in your browser settings.</p>
          <p>For assistance, contact your IT department or system administrator.</p>
          <div class="noscript-actions">
            <a href="https://enable-javascript.com/" target="_blank" rel="noopener">How to enable JavaScript</a>
            <a href="mailto:it-support@yourcompany.com">Contact Support</a>
          </div>
        </div>
      </div>
      <style>
        .noscript-warning {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: #f8f9fa;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 9999;
          padding: 20px;
        }
        
        .noscript-content {
          max-width: 600px;
          background: white;
          padding: 40px;
          border-radius: 8px;
          box-shadow: 0 10px 40px rgba(0,0,0,0.1);
          text-align: center;
        }
        
        .noscript-content h1 {
          color: #dc3545;
          margin-bottom: 20px;
        }
        
        .noscript-content p {
          margin-bottom: 15px;
          line-height: 1.6;
          color: #495057;
        }
        
        .noscript-actions {
          margin-top: 30px;
          display: flex;
          gap: 15px;
          justify-content: center;
          flex-wrap: wrap;
        }
        
        .noscript-actions a {
          padding: 12px 24px;
          background: #2563eb;
          color: white;
          text-decoration: none;
          border-radius: 6px;
          font-weight: 500;
          transition: background 0.3s;
        }
        
        .noscript-actions a:hover {
          background: #1d4ed8;
        }
      </style>
    </noscript>
    
    <!-- Loading State (shown while app loads) -->
    <div id="loading-state" class="app-loading">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <div style="margin-top: 20px;">
          <h2 style="margin-bottom: 10px;">IT Support System</h2>
          <p>Loading application...</p>
        </div>
      </div>
    </div>
    
    <!-- Main App Container -->
    <div id="root" role="main" aria-label="IT Support System Application"></div>
    
    <!-- Service Worker Registration -->
    <script>
      // Remove loading state when app loads
      window.addEventListener('DOMContentLoaded', function() {
        var loadingState = document.getElementById('loading-state');
        if (loadingState) {
          loadingState.style.display = 'none';
        }
      });
      
      // Register service worker for PWA
      if ('serviceWorker' in navigator && window.location.hostname !== 'localhost') {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('%PUBLIC_URL%/service-worker.js')
            .then(function(registration) {
              console.log('ServiceWorker registration successful with scope: ', registration.scope);
            })
            .catch(function(error) {
              console.log('ServiceWorker registration failed: ', error);
            });
        });
      }
      
      // Performance monitoring
      if (window.ENV.REACT_APP_ENABLE_DEBUG) {
        window.addEventListener('load', function() {
          var perfData = window.performance.timing;
          var pageLoadTime = perfData.loadEventEnd - perfData.navigationStart;
          console.log('Page load time: ' + pageLoadTime + 'ms');
        });
      }
      
      // Error tracking initialization
      if (window.__ERROR_TRACKING__.enabled && window.__ERROR_TRACKING__.dsn) {
        // Initialize your error tracking service here (Sentry, LogRocket, etc.)
        // Example: Sentry.init({ dsn: window.__ERROR_TRACKING__.dsn });
      }
    </script>
    
    <!-- Polyfills for older browsers (optional) -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default%2Ces6%2Ces7%2Ces2017%2Ces2018%2Ces2019%2CIntersectionObserver%2CResizeObserver"></script>
    
    <!-- Global error handler -->
    <script>
      window.addEventListener('error', function(event) {
        console.error('Global error caught:', event.error);
        // Send to error tracking service
        if (window.__ERROR_TRACKING__.enabled) {
          // Capture error here
        }
      });
      
      window.addEventListener('unhandledrejection', function(event) {
        console.error('Unhandled promise rejection:', event.reason);
        // Send to error tracking service
        if (window.__ERROR_TRACKING__.enabled) {
          // Capture rejection here
        }
      });
    </script>
  </body>
</html>