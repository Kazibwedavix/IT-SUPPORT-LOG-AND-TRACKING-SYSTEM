{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\KADZ-TECH\\\\Documents\\\\dev\\\\it-support-system\\\\frontend\\\\src\\\\pages\\\\TicketDetail.js\",\n  _s = $RefreshSig$();\n/**\r\n * TicketDetail Component - Production Ready\r\n * \r\n * Comprehensive ticket detail view with real-time updates, comments,\r\n * activity tracking, and full CRUD operations.\r\n * \r\n * Features:\r\n * - Real ticket data fetching from API\r\n * - Comments system with internal/external notes\r\n * - Ticket status management\r\n * - Role-based permissions\r\n * - Comprehensive error handling\r\n * - Activity timeline\r\n * - SLA tracking\r\n * - File attachment support\r\n * \r\n * @version 4.0.0\r\n * @author Bugema University IT Support Team\r\n */\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport Navbar from '../components/Navbar';\nimport LoadingSpinner from '../components/LoadingSpinner';\nimport ErrorBoundary from '../components/ErrorBoundary';\nimport ticketService from '../services/ticketService';\nimport userService from '../services/userService';\nimport '../styles/TicketDetail.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst TicketDetail = () => {\n  _s();\n  var _ticket$_id;\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    user,\n    isAuthenticated,\n    logout\n  } = useAuth();\n\n  // State Management\n  const [ticket, setTicket] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [comments, setComments] = useState([]);\n  const [activities, setActivities] = useState([]);\n  const [newComment, setNewComment] = useState('');\n  const [isInternalNote, setIsInternalNote] = useState(false);\n  const [submittingComment, setSubmittingComment] = useState(false);\n  const [updatingStatus, setUpdatingStatus] = useState(false);\n  const [assigningTicket, setAssigningTicket] = useState(false);\n  const [availableTechnicians, setAvailableTechnicians] = useState([]);\n  const [showAssignDropdown, setShowAssignDropdown] = useState(false);\n  const [attachments, setAttachments] = useState([]);\n  const [uploadingAttachment, setUploadingAttachment] = useState(false);\n  const [lastUpdated, setLastUpdated] = useState(null);\n\n  // Refs\n  const fileInputRef = useRef(null);\n  const refreshIntervalRef = useRef(null);\n  const abortControllerRef = useRef(null);\n\n  /**\r\n   * Validates ticket ID format\r\n   */\n  const isValidTicketId = useCallback(ticketId => {\n    if (!ticketId || ticketId === 'create' || ticketId === 'undefined' || ticketId === 'null' || ticketId.length < 12) {\n      return false;\n    }\n\n    // Check if it's a MongoDB ObjectId (24 hex chars) or ticketId format\n    const objectIdPattern = /^[0-9a-fA-F]{24}$/;\n    const ticketIdPattern = /^TKT-\\d{4}-\\d{4}$/;\n    return objectIdPattern.test(ticketId) || ticketIdPattern.test(ticketId);\n  }, []);\n\n  /**\r\n   * Checks if user has permission to view/edit ticket\r\n   */\n  const hasPermission = useCallback(() => {\n    var _ticket$createdBy, _ticket$createdBy2, _ticket$assignedTo, _ticket$assignedTo2;\n    if (!ticket || !user) return false;\n    const isOwner = ((_ticket$createdBy = ticket.createdBy) === null || _ticket$createdBy === void 0 ? void 0 : _ticket$createdBy._id) === user._id || ((_ticket$createdBy2 = ticket.createdBy) === null || _ticket$createdBy2 === void 0 ? void 0 : _ticket$createdBy2._id) === user.id;\n    const isAssigned = ((_ticket$assignedTo = ticket.assignedTo) === null || _ticket$assignedTo === void 0 ? void 0 : _ticket$assignedTo._id) === user._id || ((_ticket$assignedTo2 = ticket.assignedTo) === null || _ticket$assignedTo2 === void 0 ? void 0 : _ticket$assignedTo2._id) === user.id;\n    const isAdminOrTech = ['admin', 'technician'].includes(user.role);\n    return isOwner || isAssigned || isAdminOrTech;\n  }, [ticket, user]);\n\n  /**\r\n   * Fetches ticket data with comprehensive error handling\r\n   */\n  const fetchTicketData = useCallback(async () => {\n    // Cancel previous request if exists\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n    abortControllerRef.current = new AbortController();\n    try {\n      setLoading(true);\n      setError(null);\n      console.log(`ðŸŽ« [TICKET DETAIL] Fetching ticket: ${id}`);\n      if (!isValidTicketId(id)) {\n        throw new Error('INVALID_TICKET_ID', {\n          cause: {\n            ticketId: id\n          }\n        });\n      }\n\n      // Fetch ticket details\n      const ticketResponse = await ticketService.getTicket(id);\n      if (!ticketResponse || !ticketResponse.success) {\n        throw new Error((ticketResponse === null || ticketResponse === void 0 ? void 0 : ticketResponse.message) || 'TICKET_FETCH_FAILED');\n      }\n      const ticketData = ticketResponse.data;\n      if (!ticketData || !ticketData._id) {\n        throw new Error('INVALID_TICKET_DATA');\n      }\n\n      // Check permissions\n      if (!hasPermission()) {\n        throw new Error('PERMISSION_DENIED');\n      }\n      setTicket(ticketData);\n\n      // Fetch comments if endpoint exists\n      if (ticketService.getComments) {\n        try {\n          const commentsResponse = await ticketService.getComments(ticketData._id);\n          if (commentsResponse !== null && commentsResponse !== void 0 && commentsResponse.success) {\n            var _commentsResponse$dat;\n            const commentData = ((_commentsResponse$dat = commentsResponse.data) === null || _commentsResponse$dat === void 0 ? void 0 : _commentsResponse$dat.comments) || commentsResponse.comments || commentsResponse.data || [];\n            setComments(Array.isArray(commentData) ? commentData : []);\n          }\n        } catch (commentError) {\n          console.warn('Comments fetch failed:', commentError.message);\n        }\n      }\n\n      // Fetch activities if endpoint exists\n      if (ticketService.getActivities) {\n        try {\n          const activitiesResponse = await ticketService.getActivities(ticketData._id);\n          if (activitiesResponse !== null && activitiesResponse !== void 0 && activitiesResponse.success) {\n            var _activitiesResponse$d;\n            const activityData = ((_activitiesResponse$d = activitiesResponse.data) === null || _activitiesResponse$d === void 0 ? void 0 : _activitiesResponse$d.activities) || activitiesResponse.activities || activitiesResponse.data || [];\n            setActivities(Array.isArray(activityData) ? activityData : []);\n          }\n        } catch (activityError) {\n          console.warn('Activities fetch failed:', activityError.message);\n        }\n      }\n\n      // Fetch available technicians for assignment\n      if (['admin', 'technician'].includes(user === null || user === void 0 ? void 0 : user.role)) {\n        try {\n          const techResponse = await ticketService.getAvailableTechnicians();\n          if (techResponse !== null && techResponse !== void 0 && techResponse.success) {\n            setAvailableTechnicians(techResponse.data || []);\n          }\n        } catch (techError) {\n          console.warn('Technicians fetch failed:', techError.message);\n        }\n      }\n      setLastUpdated(new Date());\n    } catch (error) {\n      var _error$response, _error$response2, _error$response3;\n      console.error('âŒ [TICKET DETAIL ERROR]:', error);\n\n      // Handle specific error cases\n      let errorMessage = 'Unable to load ticket details.';\n      let errorType = 'fetch';\n      let retryable = true;\n      let action = null;\n      if (error.name === 'AbortError') {\n        return; // Request was cancelled, do nothing\n      } else if (error.message === 'INVALID_TICKET_ID') {\n        errorMessage = 'Invalid ticket ID format.';\n        retryable = false;\n        action = () => navigate('/tickets');\n      } else if (error.message === 'PERMISSION_DENIED') {\n        errorMessage = 'You do not have permission to view this ticket.';\n        retryable = false;\n        action = () => navigate('/tickets');\n      } else if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n        errorMessage = 'Session expired. Please log in again.';\n        retryable = false;\n        logout();\n        action = () => navigate('/login');\n      } else if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 403) {\n        errorMessage = 'Access forbidden. Insufficient permissions.';\n        retryable = false;\n        action = () => navigate('/tickets');\n      } else if (((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) === 404) {\n        errorMessage = 'Ticket not found. It may have been deleted.';\n        retryable = false;\n        action = () => navigate('/tickets');\n      } else if (error.code === 'ECONNABORTED' || error.message.includes('timeout')) {\n        errorMessage = 'Request timeout. Please check your connection.';\n      } else if (!error.response) {\n        errorMessage = 'Network error. Please check your internet connection.';\n      }\n      setError({\n        message: errorMessage,\n        type: errorType,\n        retryable,\n        action\n      });\n    } finally {\n      setLoading(false);\n      abortControllerRef.current = null;\n    }\n  }, [id, isValidTicketId, user === null || user === void 0 ? void 0 : user.role, navigate, logout]);\n\n  /**\r\n   * Handles adding a new comment\r\n   */\n  const handleAddComment = async () => {\n    if (!newComment.trim() || !ticket) return;\n    try {\n      setSubmittingComment(true);\n      const commentData = {\n        message: newComment.trim(),\n        isInternal: isInternalNote,\n        attachments: []\n      };\n      const response = await ticketService.addComment(ticket._id, commentData);\n      if (response !== null && response !== void 0 && response.success) {\n        var _response$data;\n        // Add new comment to list\n        const newCommentData = {\n          ...(((_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.comment) || commentData),\n          user: user,\n          createdAt: new Date().toISOString()\n        };\n        setComments(prev => [newCommentData, ...prev]);\n        setNewComment('');\n        setIsInternalNote(false);\n\n        // Update ticket's last updated timestamp\n        setTicket(prev => ({\n          ...prev,\n          updatedAt: new Date().toISOString()\n        }));\n      }\n    } catch (error) {\n      console.error('âŒ [ADD COMMENT ERROR]:', error);\n      setError({\n        message: 'Failed to add comment. Please try again.',\n        type: 'comment',\n        retryable: true\n      });\n    } finally {\n      setSubmittingComment(false);\n    }\n  };\n\n  /**\r\n   * Handles ticket status update\r\n   */\n  const handleStatusUpdate = async newStatus => {\n    if (!ticket || updatingStatus) return;\n    try {\n      setUpdatingStatus(true);\n      const updates = {\n        status: newStatus,\n        changeReason: `Status changed to ${newStatus} by ${user === null || user === void 0 ? void 0 : user.name}`\n      };\n\n      // Set resolved/closed timestamps\n      if (newStatus === 'resolved' && ticket.status !== 'resolved') {\n        updates.resolvedAt = new Date().toISOString();\n      } else if (newStatus === 'closed' && ticket.status !== 'closed') {\n        updates.closedAt = new Date().toISOString();\n      }\n      const response = await ticketService.updateTicket(ticket._id, updates);\n      if (response !== null && response !== void 0 && response.success) {\n        // Update local state\n        setTicket(prev => ({\n          ...prev,\n          status: newStatus,\n          updatedAt: new Date().toISOString(),\n          ...(updates.resolvedAt && {\n            resolvedAt: updates.resolvedAt\n          }),\n          ...(updates.closedAt && {\n            closedAt: updates.closedAt\n          })\n        }));\n\n        // Add to activities\n        const activity = {\n          action: 'STATUS_UPDATE',\n          description: `Status changed from ${ticket.status} to ${newStatus}`,\n          user: user,\n          timestamp: new Date().toISOString()\n        };\n        setActivities(prev => [activity, ...prev]);\n      }\n    } catch (error) {\n      console.error('âŒ [STATUS UPDATE ERROR]:', error);\n      setError({\n        message: 'Failed to update ticket status.',\n        type: 'status',\n        retryable: true\n      });\n    } finally {\n      setUpdatingStatus(false);\n    }\n  };\n\n  /**\r\n   * Handles ticket assignment\r\n   */\n  const handleAssignTicket = async technicianId => {\n    if (!ticket || assigningTicket) return;\n    try {\n      setAssigningTicket(true);\n      const updates = {\n        assignedTo: technicianId,\n        status: 'in-progress',\n        changeReason: `Ticket assigned to technician by ${user === null || user === void 0 ? void 0 : user.name}`\n      };\n      const response = await ticketService.updateTicket(ticket._id, updates);\n      if (response !== null && response !== void 0 && response.success) {\n        // Find technician details\n        const technician = availableTechnicians.find(t => t._id === technicianId);\n\n        // Update local state\n        setTicket(prev => ({\n          ...prev,\n          assignedTo: technician,\n          status: 'in-progress',\n          updatedAt: new Date().toISOString()\n        }));\n\n        // Add to activities\n        const activity = {\n          action: 'ASSIGNED',\n          description: `Ticket assigned to ${(technician === null || technician === void 0 ? void 0 : technician.name) || 'technician'}`,\n          user: user,\n          timestamp: new Date().toISOString()\n        };\n        setActivities(prev => [activity, ...prev]);\n        setShowAssignDropdown(false);\n      }\n    } catch (error) {\n      console.error('âŒ [ASSIGNMENT ERROR]:', error);\n      setError({\n        message: 'Failed to assign ticket.',\n        type: 'assignment',\n        retryable: true\n      });\n    } finally {\n      setAssigningTicket(false);\n    }\n  };\n\n  /**\r\n   * Handles file attachment upload\r\n   */\n  const handleFileUpload = async event => {\n    const files = Array.from(event.target.files);\n    if (!files.length || !ticket) return;\n    try {\n      setUploadingAttachment(true);\n      for (const file of files) {\n        // Validate file size (max 10MB)\n        if (file.size > 10 * 1024 * 1024) {\n          throw new Error(`File ${file.name} exceeds 10MB limit`);\n        }\n\n        // Validate file type\n        const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'text/plain', 'application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'];\n        if (!allowedTypes.includes(file.type)) {\n          throw new Error(`File type ${file.type} not allowed`);\n        }\n        if (ticketService.uploadAttachment) {\n          const response = await ticketService.uploadAttachment(ticket._id, file);\n          if (response !== null && response !== void 0 && response.success) {\n            setAttachments(prev => {\n              var _response$data2;\n              return [...prev, ((_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.attachment) || {\n                fileName: file.name,\n                fileUrl: URL.createObjectURL(file),\n                fileType: file.type,\n                fileSize: file.size,\n                uploadedAt: new Date().toISOString()\n              }];\n            });\n          }\n        }\n      }\n    } catch (error) {\n      console.error('âŒ [FILE UPLOAD ERROR]:', error);\n      setError({\n        message: error.message || 'Failed to upload file.',\n        type: 'upload',\n        retryable: true\n      });\n    } finally {\n      setUploadingAttachment(false);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    }\n  };\n\n  /**\r\n   * Formats date for display\r\n   */\n  const formatDate = dateString => {\n    if (!dateString) return 'N/A';\n    try {\n      const date = new Date(dateString);\n      const now = new Date();\n      const diffMs = now - date;\n      const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n      const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n      if (diffHours < 1) {\n        const diffMinutes = Math.floor(diffMs / (1000 * 60));\n        return diffMinutes < 1 ? 'Just now' : `${diffMinutes}m ago`;\n      } else if (diffHours < 24) {\n        return `${diffHours}h ago`;\n      } else if (diffDays < 7) {\n        return `${diffDays}d ago`;\n      } else {\n        return date.toLocaleString('en-US', {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric',\n          hour: '2-digit',\n          minute: '2-digit'\n        });\n      }\n    } catch (error) {\n      return 'Invalid date';\n    }\n  };\n\n  /**\r\n   * Gets SLA status color\r\n   */\n  const getSLAStatus = (dueDate, status) => {\n    if (['resolved', 'closed'].includes(status)) return 'completed';\n    if (!dueDate) return 'no-sla';\n    const now = new Date();\n    const due = new Date(dueDate);\n    const timeRemaining = due - now;\n    if (timeRemaining < 0) return 'breached';\n    if (timeRemaining < 60 * 60 * 1000) return 'critical'; // < 1 hour\n    if (timeRemaining < 4 * 60 * 60 * 1000) return 'warning'; // < 4 hours\n    return 'normal';\n  };\n\n  /**\r\n   * Gets status display configuration\r\n   */\n  const getStatusConfig = status => {\n    const config = {\n      open: {\n        label: 'Open',\n        color: '#3b82f6',\n        icon: 'â­•'\n      },\n      'in-progress': {\n        label: 'In Progress',\n        color: '#f59e0b',\n        icon: 'ðŸ”„'\n      },\n      pending: {\n        label: 'Pending',\n        color: '#8b5cf6',\n        icon: 'â¸ï¸'\n      },\n      resolved: {\n        label: 'Resolved',\n        color: '#10b981',\n        icon: 'âœ…'\n      },\n      closed: {\n        label: 'Closed',\n        color: '#6b7280',\n        icon: 'ðŸ”’'\n      }\n    };\n    return config[status] || {\n      label: status,\n      color: '#6b7280',\n      icon: 'â“'\n    };\n  };\n\n  /**\r\n   * Gets priority display configuration\r\n   */\n  const getPriorityConfig = priority => {\n    const config = {\n      low: {\n        label: 'Low',\n        color: '#059669',\n        icon: 'ðŸŸ¢'\n      },\n      medium: {\n        label: 'Medium',\n        color: '#d97706',\n        icon: 'ðŸŸ¡'\n      },\n      high: {\n        label: 'High',\n        color: '#ea580c',\n        icon: 'ðŸŸ '\n      },\n      critical: {\n        label: 'Critical',\n        color: '#dc2626',\n        icon: 'ðŸ”´'\n      }\n    };\n    return config[priority] || {\n      label: priority,\n      color: '#6b7280',\n      icon: 'â“'\n    };\n  };\n\n  /**\r\n   * Handles retry action\r\n   */\n  const handleRetry = () => {\n    setError(null);\n    fetchTicketData();\n  };\n\n  // Set up auto-refresh for ticket updates\n  useEffect(() => {\n    if (ticket && ['open', 'in-progress', 'pending'].includes(ticket.status)) {\n      refreshIntervalRef.current = setInterval(() => {\n        fetchTicketData();\n      }, 30000); // Refresh every 30 seconds for active tickets\n    }\n    return () => {\n      if (refreshIntervalRef.current) {\n        clearInterval(refreshIntervalRef.current);\n      }\n    };\n  }, [ticket, fetchTicketData]);\n\n  // Initial data fetch\n  useEffect(() => {\n    // Check authentication\n    if (!isAuthenticated) {\n      navigate('/login', {\n        state: {\n          from: `/tickets/${id}`\n        },\n        replace: true\n      });\n      return;\n    }\n\n    // Validate ticket ID\n    if (!isValidTicketId(id)) {\n      console.error('Invalid ticket ID:', id);\n      setError({\n        message: 'Invalid ticket ID or ticket not found',\n        type: 'validation',\n        retryable: false,\n        action: () => navigate('/tickets')\n      });\n      setLoading(false);\n      return;\n    }\n\n    // Fetch data\n    fetchTicketData();\n\n    // Cleanup on unmount\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n      if (refreshIntervalRef.current) {\n        clearInterval(refreshIntervalRef.current);\n      }\n    };\n  }, [id, isAuthenticated, navigate, isValidTicketId, fetchTicketData]);\n\n  // Loading state\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 588,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-container\",\n        children: /*#__PURE__*/_jsxDEV(LoadingSpinner, {\n          message: \"Loading ticket details...\",\n          fullPage: true,\n          progress: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 589,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  // Error state (no ticket)\n  if (error && !ticket) {\n    const isBackToTicketsAction = error.action && error.action.toString().includes('navigate') && error.action.toString().includes('/tickets');\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 608,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error-icon\",\n            children: \"\\u274C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 611,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Unable to Load Ticket\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 612,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"error-message\",\n            children: error.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 613,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error-actions\",\n            children: [error.retryable && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleRetry,\n              className: \"btn btn-primary\",\n              \"aria-label\": \"Retry loading ticket\",\n              children: \"Try Again\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 616,\n              columnNumber: 17\n            }, this), error.action ? /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: error.action,\n              className: \"btn btn-secondary\",\n              \"aria-label\": isBackToTicketsAction ? 'Back to tickets' : 'Take action',\n              children: isBackToTicketsAction ? 'Back to Tickets' : 'Take Action'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 625,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => navigate('/tickets'),\n              className: \"btn btn-secondary\",\n              \"aria-label\": \"Back to tickets\",\n              children: \"Back to Tickets\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 633,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 614,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 610,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 609,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  // No ticket found\n  if (!ticket) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 652,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"not-found\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"not-found-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"not-found-icon\",\n            children: \"\\uD83D\\uDD0D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 655,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Ticket Not Found\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 656,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"The ticket you're looking for doesn't exist or has been deleted.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 657,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => navigate('/tickets'),\n            className: \"btn btn-primary\",\n            \"aria-label\": \"View all tickets\",\n            children: \"View All Tickets\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 658,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 654,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 653,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  // Check permissions\n  if (!hasPermission()) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 675,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"permission-denied\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"permission-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"permission-icon\",\n            children: \"\\uD83D\\uDEAB\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 678,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Access Denied\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 679,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"You do not have permission to view this ticket.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 680,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => navigate('/tickets'),\n            className: \"btn btn-primary\",\n            \"aria-label\": \"Back to tickets\",\n            children: \"Back to Tickets\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 681,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 677,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 676,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n  const statusConfig = getStatusConfig(ticket.status);\n  const priorityConfig = getPriorityConfig(ticket.priority);\n  const slaStatus = getSLAStatus(ticket.slaDueDate, ticket.status);\n  return /*#__PURE__*/_jsxDEV(ErrorBoundary, {\n    children: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 701,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ticket-detail-page\",\n        children: [/*#__PURE__*/_jsxDEV(\"header\", {\n          className: \"ticket-header\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-main\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"ticket-meta\",\n              children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                className: \"ticket-title\",\n                children: ticket.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 707,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"meta-tags\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ticket-id\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"ID:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 710,\n                    columnNumber: 21\n                  }, this), \" \", ticket.ticketId || `TKT-${(_ticket$_id = ticket._id) === null || _ticket$_id === void 0 ? void 0 : _ticket$_id.substring(0, 8).toUpperCase()}`]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 709,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"status-badge\",\n                  style: {\n                    backgroundColor: statusConfig.color\n                  },\n                  \"aria-label\": `Status: ${statusConfig.label}`,\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"status-icon\",\n                    children: statusConfig.icon\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 717,\n                    columnNumber: 21\n                  }, this), statusConfig.label]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 712,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"priority-badge\",\n                  style: {\n                    backgroundColor: priorityConfig.color\n                  },\n                  \"aria-label\": `Priority: ${priorityConfig.label}`,\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"priority-icon\",\n                    children: priorityConfig.icon\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 725,\n                    columnNumber: 21\n                  }, this), priorityConfig.label]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 720,\n                  columnNumber: 19\n                }, this), ticket.slaDueDate && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `sla-badge sla-${slaStatus}`,\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"sla-icon\",\n                    children: slaStatus === 'breached' ? 'â°' : slaStatus === 'critical' ? 'ðŸš¨' : slaStatus === 'warning' ? 'âš ï¸' : 'âœ…'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 730,\n                    columnNumber: 23\n                  }, this), \"SLA: \", formatDate(ticket.slaDueDate)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 729,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 708,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 706,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"header-actions\",\n              children: [['admin', 'technician'].includes(user === null || user === void 0 ? void 0 : user.role) && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"action-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"select\", {\n                  className: \"action-select status-select\",\n                  value: ticket.status,\n                  onChange: e => handleStatusUpdate(e.target.value),\n                  disabled: updatingStatus,\n                  \"aria-label\": \"Update ticket status\",\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"open\",\n                    children: \"Open\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 752,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"in-progress\",\n                    children: \"In Progress\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 753,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"pending\",\n                    children: \"Pending\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 754,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"resolved\",\n                    children: \"Resolved\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 755,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"closed\",\n                    children: \"Closed\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 756,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 745,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"assign-dropdown\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"action-btn assign-btn\",\n                    onClick: () => setShowAssignDropdown(!showAssignDropdown),\n                    disabled: assigningTicket,\n                    \"aria-label\": \"Assign ticket\",\n                    children: assigningTicket ? 'Assigning...' : ticket.assignedTo ? 'Reassign' : 'Assign'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 761,\n                    columnNumber: 23\n                  }, this), showAssignDropdown && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"dropdown-menu\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"dropdown-header\",\n                      children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Assign to:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 774,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 773,\n                      columnNumber: 27\n                    }, this), availableTechnicians.length > 0 ? availableTechnicians.map(tech => /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"dropdown-item\",\n                      onClick: () => handleAssignTicket(tech._id),\n                      \"aria-label\": `Assign to ${tech.name}`,\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"tech-name\",\n                        children: tech.name\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 784,\n                        columnNumber: 33\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"tech-role\",\n                        children: tech.role\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 785,\n                        columnNumber: 33\n                      }, this)]\n                    }, tech._id, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 778,\n                      columnNumber: 31\n                    }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"dropdown-empty\",\n                      children: \"No technicians available\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 789,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 772,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 760,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 743,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"action-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => navigate('/tickets'),\n                  className: \"btn btn-secondary\",\n                  \"aria-label\": \"Back to tickets list\",\n                  children: \"\\u2190 Back to List\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 800,\n                  columnNumber: 19\n                }, this), lastUpdated && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"last-updated\",\n                  children: [\"Updated: \", formatDate(lastUpdated)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 809,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 799,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 741,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 705,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 704,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `alert alert-${error.type}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"alert-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Error:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 822,\n              columnNumber: 17\n            }, this), \" \", error.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 821,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"alert-actions\",\n            children: [error.retryable && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleRetry,\n              className: \"btn btn-sm\",\n              children: \"Retry\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 826,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setError(null),\n              className: \"btn btn-sm btn-text\",\n              \"aria-label\": \"Dismiss error\",\n              children: \"Dismiss\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 830,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 824,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 820,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n          className: \"ticket-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ticket-main\",\n            children: [/*#__PURE__*/_jsxDEV(\"section\", {\n              className: \"ticket-description\",\n              \"aria-label\": \"Ticket description\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"section-title\",\n                children: \"Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 847,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"description-content\",\n                children: ticket.description || 'No description provided.'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 848,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 846,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n              className: \"ticket-info\",\n              \"aria-label\": \"Ticket information\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"section-title\",\n                children: \"Ticket Information\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 855,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"info-grid\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Created\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 858,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-value\",\n                    children: formatDate(ticket.createdAt)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 859,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 857,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Last Updated\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 862,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-value\",\n                    children: formatDate(ticket.updatedAt)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 863,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 861,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Category\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 866,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-value\",\n                    children: ticket.category || 'Not specified'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 867,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 865,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Sub Category\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 870,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-value\",\n                    children: ticket.subCategory || 'Not specified'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 871,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 869,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Campus\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 874,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-value\",\n                    children: ticket.campus || 'Not specified'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 875,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 873,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Location\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 878,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-value\",\n                    children: ticket.location || 'Not specified'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 879,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 877,\n                  columnNumber: 19\n                }, this), ticket.createdBy && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Created By\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 883,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"user-info\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"user-name\",\n                      children: ticket.createdBy.name || `${ticket.createdBy.firstName} ${ticket.createdBy.lastName}`\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 885,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"user-email\",\n                      children: ticket.createdBy.email\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 889,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"user-role\",\n                      children: ticket.createdBy.role\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 890,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 884,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 882,\n                  columnNumber: 21\n                }, this), ticket.assignedTo && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Assigned To\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 896,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"user-info\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"user-name\",\n                      children: ticket.assignedTo.name || `${ticket.assignedTo.firstName} ${ticket.assignedTo.lastName}`\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 898,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"user-email\",\n                      children: ticket.assignedTo.email\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 902,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"user-role\",\n                      children: ticket.assignedTo.role\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 903,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 897,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 895,\n                  columnNumber: 21\n                }, this), ticket.resolvedAt && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Resolved\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 909,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-value\",\n                    children: formatDate(ticket.resolvedAt)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 910,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 908,\n                  columnNumber: 21\n                }, this), ticket.closedAt && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"info-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-label\",\n                    children: \"Closed\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 915,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"info-value\",\n                    children: formatDate(ticket.closedAt)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 916,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 914,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 856,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 854,\n              columnNumber: 15\n            }, this), (attachments.length > 0 || (user === null || user === void 0 ? void 0 : user.role) === 'technician' || (user === null || user === void 0 ? void 0 : user.role) === 'admin') && /*#__PURE__*/_jsxDEV(\"section\", {\n              className: \"ticket-attachments\",\n              \"aria-label\": \"Ticket attachments\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"section-title\",\n                children: [\"Attachments\", ['technician', 'admin'].includes(user === null || user === void 0 ? void 0 : user.role) && /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn-link\",\n                  onClick: () => {\n                    var _fileInputRef$current;\n                    return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n                  },\n                  disabled: uploadingAttachment,\n                  \"aria-label\": \"Add attachment\",\n                  children: \"+ Add\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 928,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 925,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                ref: fileInputRef,\n                onChange: handleFileUpload,\n                multiple: true,\n                accept: \".jpg,.jpeg,.png,.gif,.pdf,.doc,.docx,.txt,.xls,.xlsx\",\n                style: {\n                  display: 'none'\n                },\n                \"aria-label\": \"Upload file\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 939,\n                columnNumber: 19\n              }, this), uploadingAttachment && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"uploading\",\n                children: /*#__PURE__*/_jsxDEV(LoadingSpinner, {\n                  message: \"Uploading...\",\n                  size: \"small\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 951,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 950,\n                columnNumber: 21\n              }, this), attachments.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"attachments-list\",\n                children: attachments.map((file, index) => {\n                  var _file$fileType, _file$fileType2, _file$fileType3;\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"attachment-item\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"attachment-icon\",\n                      children: (_file$fileType = file.fileType) !== null && _file$fileType !== void 0 && _file$fileType.startsWith('image/') ? 'ðŸ–¼ï¸' : file.fileType === 'application/pdf' ? 'ðŸ“„' : (_file$fileType2 = file.fileType) !== null && _file$fileType2 !== void 0 && _file$fileType2.includes('word') ? 'ðŸ“' : (_file$fileType3 = file.fileType) !== null && _file$fileType3 !== void 0 && _file$fileType3.includes('excel') ? 'ðŸ“Š' : 'ðŸ“Ž'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 959,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"attachment-info\",\n                      children: [/*#__PURE__*/_jsxDEV(\"a\", {\n                        href: file.fileUrl,\n                        target: \"_blank\",\n                        rel: \"noopener noreferrer\",\n                        className: \"attachment-name\",\n                        \"aria-label\": `Download ${file.fileName}`,\n                        children: file.fileName\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 966,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"attachment-size\",\n                        children: [(file.fileSize / 1024).toFixed(1), \" KB\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 975,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 965,\n                      columnNumber: 27\n                    }, this)]\n                  }, index, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 958,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 956,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"no-attachments\",\n                children: \"No attachments yet.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 983,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 924,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 844,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ticket-sidebar\",\n            children: /*#__PURE__*/_jsxDEV(\"section\", {\n              className: \"comments-section\",\n              \"aria-label\": \"Comments and activity\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"section-title\",\n                children: \"Activity & Comments\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 993,\n                columnNumber: 17\n              }, this), activities.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"activities-timeline\",\n                children: activities.slice(0, 5).map((activity, index) => {\n                  var _activity$user;\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"activity-item\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"activity-icon\",\n                      children: activity.action === 'STATUS_UPDATE' ? 'ðŸ”„' : activity.action === 'ASSIGNED' ? 'ðŸ‘¤' : activity.action === 'COMMENT_ADDED' ? 'ðŸ’¬' : 'ðŸ“'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1000,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"activity-content\",\n                      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                        className: \"activity-description\",\n                        children: activity.description\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1006,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"activity-meta\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"activity-user\",\n                          children: (_activity$user = activity.user) === null || _activity$user === void 0 ? void 0 : _activity$user.name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1008,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"activity-time\",\n                          children: formatDate(activity.timestamp)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1009,\n                          columnNumber: 29\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1007,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1005,\n                      columnNumber: 25\n                    }, this)]\n                  }, index, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 999,\n                    columnNumber: 23\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 997,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"comments-list\",\n                children: comments.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"no-comments\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: \"No comments yet. Be the first to add one.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1021,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1020,\n                  columnNumber: 21\n                }, this) : comments.slice(0, 10).map((comment, index) => {\n                  var _comment$user, _comment$user2, _comment$user3, _comment$user4;\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `comment-item ${comment.isInternal ? 'internal' : ''}`,\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"comment-header\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"comment-author\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"author-name\",\n                          children: ((_comment$user = comment.user) === null || _comment$user === void 0 ? void 0 : _comment$user.name) || `${(_comment$user2 = comment.user) === null || _comment$user2 === void 0 ? void 0 : _comment$user2.firstName} ${(_comment$user3 = comment.user) === null || _comment$user3 === void 0 ? void 0 : _comment$user3.lastName}` || 'Unknown User'\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1031,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"author-role\",\n                          children: (_comment$user4 = comment.user) === null || _comment$user4 === void 0 ? void 0 : _comment$user4.role\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1036,\n                          columnNumber: 29\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1030,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"comment-meta\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"comment-date\",\n                          children: formatDate(comment.createdAt)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1039,\n                          columnNumber: 29\n                        }, this), comment.isInternal && /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"internal-badge\",\n                          \"aria-label\": \"Internal note\",\n                          children: \"Internal\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1041,\n                          columnNumber: 31\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1038,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1029,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"comment-content\",\n                      children: comment.message || comment.content\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1047,\n                      columnNumber: 25\n                    }, this)]\n                  }, comment._id || index, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1025,\n                    columnNumber: 23\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1018,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"add-comment\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"form-title\",\n                  children: \"Add Comment\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1057,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                  value: newComment,\n                  onChange: e => setNewComment(e.target.value),\n                  placeholder: \"Type your comment here...\",\n                  rows: \"4\",\n                  maxLength: \"2000\",\n                  \"aria-label\": \"Comment text\",\n                  disabled: submittingComment\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1058,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"comment-actions\",\n                  children: [['technician', 'admin'].includes(user === null || user === void 0 ? void 0 : user.role) && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"internal-note-option\",\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"checkbox\",\n                      id: \"internal-note\",\n                      checked: isInternalNote,\n                      onChange: e => setIsInternalNote(e.target.checked),\n                      \"aria-label\": \"Mark as internal note\",\n                      disabled: submittingComment\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1071,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                      htmlFor: \"internal-note\",\n                      children: \"Internal note (staff only)\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1079,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1070,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: handleAddComment,\n                    disabled: !newComment.trim() || submittingComment,\n                    className: \"btn btn-primary\",\n                    \"aria-label\": \"Post comment\",\n                    children: submittingComment ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                      children: [/*#__PURE__*/_jsxDEV(LoadingSpinner, {\n                        size: \"small\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1093,\n                        columnNumber: 27\n                      }, this), \"Posting...\"]\n                    }, void 0, true) : 'Post Comment'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1085,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1068,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"comment-help\",\n                  children: /*#__PURE__*/_jsxDEV(\"small\", {\n                    children: \"Comments can be marked as internal for staff communication only.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1103,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1102,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1056,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 992,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 990,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 842,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n          className: \"ticket-footer\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"footer-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ticket-age\",\n                children: [\"Ticket created \", formatDate(ticket.createdAt)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1114,\n                columnNumber: 17\n              }, this), ticket.slaDueDate && slaStatus !== 'completed' && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `sla-status sla-${slaStatus}`,\n                children: slaStatus === 'breached' ? 'SLA Breached' : slaStatus === 'critical' ? 'SLA Critical' : slaStatus === 'warning' ? 'SLA Warning' : 'SLA On Track'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1118,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1113,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"footer-actions\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: fetchTicketData,\n                className: \"btn btn-text\",\n                \"aria-label\": \"Refresh ticket data\",\n                children: \"\\u21BB Refresh\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1127,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1126,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1112,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1111,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 702,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 699,\n    columnNumber: 5\n  }, this);\n};\n_s(TicketDetail, \"OwAeWMuE+w8t5nLiALzH09XaUGc=\", false, function () {\n  return [useParams, useNavigate, useAuth];\n});\n_c = TicketDetail;\nexport default TicketDetail;\nvar _c;\n$RefreshReg$(_c, \"TicketDetail\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useParams","useNavigate","useAuth","Navbar","LoadingSpinner","ErrorBoundary","ticketService","userService","jsxDEV","_jsxDEV","Fragment","_Fragment","TicketDetail","_s","_ticket$_id","id","navigate","user","isAuthenticated","logout","ticket","setTicket","loading","setLoading","error","setError","comments","setComments","activities","setActivities","newComment","setNewComment","isInternalNote","setIsInternalNote","submittingComment","setSubmittingComment","updatingStatus","setUpdatingStatus","assigningTicket","setAssigningTicket","availableTechnicians","setAvailableTechnicians","showAssignDropdown","setShowAssignDropdown","attachments","setAttachments","uploadingAttachment","setUploadingAttachment","lastUpdated","setLastUpdated","fileInputRef","refreshIntervalRef","abortControllerRef","isValidTicketId","ticketId","length","objectIdPattern","ticketIdPattern","test","hasPermission","_ticket$createdBy","_ticket$createdBy2","_ticket$assignedTo","_ticket$assignedTo2","isOwner","createdBy","_id","isAssigned","assignedTo","isAdminOrTech","includes","role","fetchTicketData","current","abort","AbortController","console","log","Error","cause","ticketResponse","getTicket","success","message","ticketData","data","getComments","commentsResponse","_commentsResponse$dat","commentData","Array","isArray","commentError","warn","getActivities","activitiesResponse","_activitiesResponse$d","activityData","activityError","techResponse","getAvailableTechnicians","techError","Date","_error$response","_error$response2","_error$response3","errorMessage","errorType","retryable","action","name","response","status","code","type","handleAddComment","trim","isInternal","addComment","_response$data","newCommentData","comment","createdAt","toISOString","prev","updatedAt","handleStatusUpdate","newStatus","updates","changeReason","resolvedAt","closedAt","updateTicket","activity","description","timestamp","handleAssignTicket","technicianId","technician","find","t","handleFileUpload","event","files","from","target","file","size","allowedTypes","uploadAttachment","_response$data2","attachment","fileName","fileUrl","URL","createObjectURL","fileType","fileSize","uploadedAt","value","formatDate","dateString","date","now","diffMs","diffHours","Math","floor","diffDays","diffMinutes","toLocaleString","year","month","day","hour","minute","getSLAStatus","dueDate","due","timeRemaining","getStatusConfig","config","open","label","color","icon","pending","resolved","closed","getPriorityConfig","priority","low","medium","high","critical","handleRetry","setInterval","clearInterval","state","replace","children","_jsxFileName","lineNumber","columnNumber","className","fullPage","progress","isBackToTicketsAction","toString","onClick","statusConfig","priorityConfig","slaStatus","slaDueDate","title","substring","toUpperCase","style","backgroundColor","onChange","e","disabled","map","tech","category","subCategory","campus","location","firstName","lastName","email","_fileInputRef$current","click","ref","multiple","accept","display","index","_file$fileType","_file$fileType2","_file$fileType3","startsWith","href","rel","toFixed","slice","_activity$user","_comment$user","_comment$user2","_comment$user3","_comment$user4","content","placeholder","rows","maxLength","checked","htmlFor","_c","$RefreshReg$"],"sources":["C:/Users/KADZ-TECH/Documents/dev/it-support-system/frontend/src/pages/TicketDetail.js"],"sourcesContent":["/**\r\n * TicketDetail Component - Production Ready\r\n * \r\n * Comprehensive ticket detail view with real-time updates, comments,\r\n * activity tracking, and full CRUD operations.\r\n * \r\n * Features:\r\n * - Real ticket data fetching from API\r\n * - Comments system with internal/external notes\r\n * - Ticket status management\r\n * - Role-based permissions\r\n * - Comprehensive error handling\r\n * - Activity timeline\r\n * - SLA tracking\r\n * - File attachment support\r\n * \r\n * @version 4.0.0\r\n * @author Bugema University IT Support Team\r\n */\r\n\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport Navbar from '../components/Navbar';\r\nimport LoadingSpinner from '../components/LoadingSpinner';\r\nimport ErrorBoundary from '../components/ErrorBoundary';\r\nimport ticketService from '../services/ticketService';\r\nimport userService from '../services/userService';\r\nimport '../styles/TicketDetail.css';\r\n\r\nconst TicketDetail = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const { user, isAuthenticated, logout } = useAuth();\r\n  \r\n  // State Management\r\n  const [ticket, setTicket] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [comments, setComments] = useState([]);\r\n  const [activities, setActivities] = useState([]);\r\n  const [newComment, setNewComment] = useState('');\r\n  const [isInternalNote, setIsInternalNote] = useState(false);\r\n  const [submittingComment, setSubmittingComment] = useState(false);\r\n  const [updatingStatus, setUpdatingStatus] = useState(false);\r\n  const [assigningTicket, setAssigningTicket] = useState(false);\r\n  const [availableTechnicians, setAvailableTechnicians] = useState([]);\r\n  const [showAssignDropdown, setShowAssignDropdown] = useState(false);\r\n  const [attachments, setAttachments] = useState([]);\r\n  const [uploadingAttachment, setUploadingAttachment] = useState(false);\r\n  const [lastUpdated, setLastUpdated] = useState(null);\r\n  \r\n  // Refs\r\n  const fileInputRef = useRef(null);\r\n  const refreshIntervalRef = useRef(null);\r\n  const abortControllerRef = useRef(null);\r\n\r\n  /**\r\n   * Validates ticket ID format\r\n   */\r\n  const isValidTicketId = useCallback((ticketId) => {\r\n    if (!ticketId || \r\n        ticketId === 'create' || \r\n        ticketId === 'undefined' || \r\n        ticketId === 'null' ||\r\n        ticketId.length < 12) {\r\n      return false;\r\n    }\r\n    \r\n    // Check if it's a MongoDB ObjectId (24 hex chars) or ticketId format\r\n    const objectIdPattern = /^[0-9a-fA-F]{24}$/;\r\n    const ticketIdPattern = /^TKT-\\d{4}-\\d{4}$/;\r\n    \r\n    return objectIdPattern.test(ticketId) || ticketIdPattern.test(ticketId);\r\n  }, []);\r\n\r\n  /**\r\n   * Checks if user has permission to view/edit ticket\r\n   */\r\n  const hasPermission = useCallback(() => {\r\n    if (!ticket || !user) return false;\r\n    \r\n    const isOwner = ticket.createdBy?._id === user._id || \r\n                    ticket.createdBy?._id === user.id;\r\n    const isAssigned = ticket.assignedTo?._id === user._id || \r\n                       ticket.assignedTo?._id === user.id;\r\n    const isAdminOrTech = ['admin', 'technician'].includes(user.role);\r\n    \r\n    return isOwner || isAssigned || isAdminOrTech;\r\n  }, [ticket, user]);\r\n\r\n  /**\r\n   * Fetches ticket data with comprehensive error handling\r\n   */\r\n  const fetchTicketData = useCallback(async () => {\r\n    // Cancel previous request if exists\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n    }\r\n    \r\n    abortControllerRef.current = new AbortController();\r\n    \r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      console.log(`ðŸŽ« [TICKET DETAIL] Fetching ticket: ${id}`);\r\n      \r\n      if (!isValidTicketId(id)) {\r\n        throw new Error('INVALID_TICKET_ID', {\r\n          cause: { ticketId: id }\r\n        });\r\n      }\r\n\r\n      // Fetch ticket details\r\n      const ticketResponse = await ticketService.getTicket(id);\r\n      \r\n      if (!ticketResponse || !ticketResponse.success) {\r\n        throw new Error(ticketResponse?.message || 'TICKET_FETCH_FAILED');\r\n      }\r\n\r\n      const ticketData = ticketResponse.data;\r\n      \r\n      if (!ticketData || !ticketData._id) {\r\n        throw new Error('INVALID_TICKET_DATA');\r\n      }\r\n\r\n      // Check permissions\r\n      if (!hasPermission()) {\r\n        throw new Error('PERMISSION_DENIED');\r\n      }\r\n\r\n      setTicket(ticketData);\r\n      \r\n      // Fetch comments if endpoint exists\r\n      if (ticketService.getComments) {\r\n        try {\r\n          const commentsResponse = await ticketService.getComments(ticketData._id);\r\n          if (commentsResponse?.success) {\r\n            const commentData = commentsResponse.data?.comments || \r\n                               commentsResponse.comments || \r\n                               commentsResponse.data || \r\n                               [];\r\n            setComments(Array.isArray(commentData) ? commentData : []);\r\n          }\r\n        } catch (commentError) {\r\n          console.warn('Comments fetch failed:', commentError.message);\r\n        }\r\n      }\r\n\r\n      // Fetch activities if endpoint exists\r\n      if (ticketService.getActivities) {\r\n        try {\r\n          const activitiesResponse = await ticketService.getActivities(ticketData._id);\r\n          if (activitiesResponse?.success) {\r\n            const activityData = activitiesResponse.data?.activities || \r\n                                activitiesResponse.activities || \r\n                                activitiesResponse.data || \r\n                                [];\r\n            setActivities(Array.isArray(activityData) ? activityData : []);\r\n          }\r\n        } catch (activityError) {\r\n          console.warn('Activities fetch failed:', activityError.message);\r\n        }\r\n      }\r\n\r\n      // Fetch available technicians for assignment\r\n      if (['admin', 'technician'].includes(user?.role)) {\r\n        try {\r\n          const techResponse = await ticketService.getAvailableTechnicians();\r\n          if (techResponse?.success) {\r\n            setAvailableTechnicians(techResponse.data || []);\r\n          }\r\n        } catch (techError) {\r\n          console.warn('Technicians fetch failed:', techError.message);\r\n        }\r\n      }\r\n\r\n      setLastUpdated(new Date());\r\n      \r\n    } catch (error) {\r\n      console.error('âŒ [TICKET DETAIL ERROR]:', error);\r\n      \r\n      // Handle specific error cases\r\n      let errorMessage = 'Unable to load ticket details.';\r\n      let errorType = 'fetch';\r\n      let retryable = true;\r\n      let action = null;\r\n\r\n      if (error.name === 'AbortError') {\r\n        return; // Request was cancelled, do nothing\r\n      } else if (error.message === 'INVALID_TICKET_ID') {\r\n        errorMessage = 'Invalid ticket ID format.';\r\n        retryable = false;\r\n        action = () => navigate('/tickets');\r\n      } else if (error.message === 'PERMISSION_DENIED') {\r\n        errorMessage = 'You do not have permission to view this ticket.';\r\n        retryable = false;\r\n        action = () => navigate('/tickets');\r\n      } else if (error.response?.status === 401) {\r\n        errorMessage = 'Session expired. Please log in again.';\r\n        retryable = false;\r\n        logout();\r\n        action = () => navigate('/login');\r\n      } else if (error.response?.status === 403) {\r\n        errorMessage = 'Access forbidden. Insufficient permissions.';\r\n        retryable = false;\r\n        action = () => navigate('/tickets');\r\n      } else if (error.response?.status === 404) {\r\n        errorMessage = 'Ticket not found. It may have been deleted.';\r\n        retryable = false;\r\n        action = () => navigate('/tickets');\r\n      } else if (error.code === 'ECONNABORTED' || error.message.includes('timeout')) {\r\n        errorMessage = 'Request timeout. Please check your connection.';\r\n      } else if (!error.response) {\r\n        errorMessage = 'Network error. Please check your internet connection.';\r\n      }\r\n\r\n      setError({\r\n        message: errorMessage,\r\n        type: errorType,\r\n        retryable,\r\n        action\r\n      });\r\n      \r\n    } finally {\r\n      setLoading(false);\r\n      abortControllerRef.current = null;\r\n    }\r\n  }, [id, isValidTicketId, user?.role, navigate, logout]);\r\n\r\n  /**\r\n   * Handles adding a new comment\r\n   */\r\n  const handleAddComment = async () => {\r\n    if (!newComment.trim() || !ticket) return;\r\n    \r\n    try {\r\n      setSubmittingComment(true);\r\n      \r\n      const commentData = {\r\n        message: newComment.trim(),\r\n        isInternal: isInternalNote,\r\n        attachments: []\r\n      };\r\n\r\n      const response = await ticketService.addComment(ticket._id, commentData);\r\n      \r\n      if (response?.success) {\r\n        // Add new comment to list\r\n        const newCommentData = {\r\n          ...response.data?.comment || commentData,\r\n          user: user,\r\n          createdAt: new Date().toISOString()\r\n        };\r\n        \r\n        setComments(prev => [newCommentData, ...prev]);\r\n        setNewComment('');\r\n        setIsInternalNote(false);\r\n        \r\n        // Update ticket's last updated timestamp\r\n        setTicket(prev => ({\r\n          ...prev,\r\n          updatedAt: new Date().toISOString()\r\n        }));\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('âŒ [ADD COMMENT ERROR]:', error);\r\n      setError({\r\n        message: 'Failed to add comment. Please try again.',\r\n        type: 'comment',\r\n        retryable: true\r\n      });\r\n    } finally {\r\n      setSubmittingComment(false);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handles ticket status update\r\n   */\r\n  const handleStatusUpdate = async (newStatus) => {\r\n    if (!ticket || updatingStatus) return;\r\n    \r\n    try {\r\n      setUpdatingStatus(true);\r\n      \r\n      const updates = { \r\n        status: newStatus,\r\n        changeReason: `Status changed to ${newStatus} by ${user?.name}`\r\n      };\r\n      \r\n      // Set resolved/closed timestamps\r\n      if (newStatus === 'resolved' && ticket.status !== 'resolved') {\r\n        updates.resolvedAt = new Date().toISOString();\r\n      } else if (newStatus === 'closed' && ticket.status !== 'closed') {\r\n        updates.closedAt = new Date().toISOString();\r\n      }\r\n      \r\n      const response = await ticketService.updateTicket(ticket._id, updates);\r\n      \r\n      if (response?.success) {\r\n        // Update local state\r\n        setTicket(prev => ({\r\n          ...prev,\r\n          status: newStatus,\r\n          updatedAt: new Date().toISOString(),\r\n          ...(updates.resolvedAt && { resolvedAt: updates.resolvedAt }),\r\n          ...(updates.closedAt && { closedAt: updates.closedAt })\r\n        }));\r\n        \r\n        // Add to activities\r\n        const activity = {\r\n          action: 'STATUS_UPDATE',\r\n          description: `Status changed from ${ticket.status} to ${newStatus}`,\r\n          user: user,\r\n          timestamp: new Date().toISOString()\r\n        };\r\n        setActivities(prev => [activity, ...prev]);\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('âŒ [STATUS UPDATE ERROR]:', error);\r\n      setError({\r\n        message: 'Failed to update ticket status.',\r\n        type: 'status',\r\n        retryable: true\r\n      });\r\n    } finally {\r\n      setUpdatingStatus(false);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handles ticket assignment\r\n   */\r\n  const handleAssignTicket = async (technicianId) => {\r\n    if (!ticket || assigningTicket) return;\r\n    \r\n    try {\r\n      setAssigningTicket(true);\r\n      \r\n      const updates = {\r\n        assignedTo: technicianId,\r\n        status: 'in-progress',\r\n        changeReason: `Ticket assigned to technician by ${user?.name}`\r\n      };\r\n      \r\n      const response = await ticketService.updateTicket(ticket._id, updates);\r\n      \r\n      if (response?.success) {\r\n        // Find technician details\r\n        const technician = availableTechnicians.find(t => t._id === technicianId);\r\n        \r\n        // Update local state\r\n        setTicket(prev => ({\r\n          ...prev,\r\n          assignedTo: technician,\r\n          status: 'in-progress',\r\n          updatedAt: new Date().toISOString()\r\n        }));\r\n        \r\n        // Add to activities\r\n        const activity = {\r\n          action: 'ASSIGNED',\r\n          description: `Ticket assigned to ${technician?.name || 'technician'}`,\r\n          user: user,\r\n          timestamp: new Date().toISOString()\r\n        };\r\n        setActivities(prev => [activity, ...prev]);\r\n        \r\n        setShowAssignDropdown(false);\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('âŒ [ASSIGNMENT ERROR]:', error);\r\n      setError({\r\n        message: 'Failed to assign ticket.',\r\n        type: 'assignment',\r\n        retryable: true\r\n      });\r\n    } finally {\r\n      setAssigningTicket(false);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handles file attachment upload\r\n   */\r\n  const handleFileUpload = async (event) => {\r\n    const files = Array.from(event.target.files);\r\n    if (!files.length || !ticket) return;\r\n    \r\n    try {\r\n      setUploadingAttachment(true);\r\n      \r\n      for (const file of files) {\r\n        // Validate file size (max 10MB)\r\n        if (file.size > 10 * 1024 * 1024) {\r\n          throw new Error(`File ${file.name} exceeds 10MB limit`);\r\n        }\r\n        \r\n        // Validate file type\r\n        const allowedTypes = [\r\n          'image/jpeg', 'image/png', 'image/gif', 'application/pdf',\r\n          'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n          'text/plain', 'application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\r\n        ];\r\n        \r\n        if (!allowedTypes.includes(file.type)) {\r\n          throw new Error(`File type ${file.type} not allowed`);\r\n        }\r\n        \r\n        if (ticketService.uploadAttachment) {\r\n          const response = await ticketService.uploadAttachment(ticket._id, file);\r\n          \r\n          if (response?.success) {\r\n            setAttachments(prev => [...prev, response.data?.attachment || {\r\n              fileName: file.name,\r\n              fileUrl: URL.createObjectURL(file),\r\n              fileType: file.type,\r\n              fileSize: file.size,\r\n              uploadedAt: new Date().toISOString()\r\n            }]);\r\n          }\r\n        }\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('âŒ [FILE UPLOAD ERROR]:', error);\r\n      setError({\r\n        message: error.message || 'Failed to upload file.',\r\n        type: 'upload',\r\n        retryable: true\r\n      });\r\n    } finally {\r\n      setUploadingAttachment(false);\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Formats date for display\r\n   */\r\n  const formatDate = (dateString) => {\r\n    if (!dateString) return 'N/A';\r\n    \r\n    try {\r\n      const date = new Date(dateString);\r\n      const now = new Date();\r\n      const diffMs = now - date;\r\n      const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\r\n      const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\r\n      \r\n      if (diffHours < 1) {\r\n        const diffMinutes = Math.floor(diffMs / (1000 * 60));\r\n        return diffMinutes < 1 ? 'Just now' : `${diffMinutes}m ago`;\r\n      } else if (diffHours < 24) {\r\n        return `${diffHours}h ago`;\r\n      } else if (diffDays < 7) {\r\n        return `${diffDays}d ago`;\r\n      } else {\r\n        return date.toLocaleString('en-US', {\r\n          year: 'numeric',\r\n          month: 'short',\r\n          day: 'numeric',\r\n          hour: '2-digit',\r\n          minute: '2-digit'\r\n        });\r\n      }\r\n    } catch (error) {\r\n      return 'Invalid date';\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Gets SLA status color\r\n   */\r\n  const getSLAStatus = (dueDate, status) => {\r\n    if (['resolved', 'closed'].includes(status)) return 'completed';\r\n    if (!dueDate) return 'no-sla';\r\n    \r\n    const now = new Date();\r\n    const due = new Date(dueDate);\r\n    const timeRemaining = due - now;\r\n    \r\n    if (timeRemaining < 0) return 'breached';\r\n    if (timeRemaining < 60 * 60 * 1000) return 'critical'; // < 1 hour\r\n    if (timeRemaining < 4 * 60 * 60 * 1000) return 'warning'; // < 4 hours\r\n    return 'normal';\r\n  };\r\n\r\n  /**\r\n   * Gets status display configuration\r\n   */\r\n  const getStatusConfig = (status) => {\r\n    const config = {\r\n      open: { label: 'Open', color: '#3b82f6', icon: 'â­•' },\r\n      'in-progress': { label: 'In Progress', color: '#f59e0b', icon: 'ðŸ”„' },\r\n      pending: { label: 'Pending', color: '#8b5cf6', icon: 'â¸ï¸' },\r\n      resolved: { label: 'Resolved', color: '#10b981', icon: 'âœ…' },\r\n      closed: { label: 'Closed', color: '#6b7280', icon: 'ðŸ”’' }\r\n    };\r\n    return config[status] || { label: status, color: '#6b7280', icon: 'â“' };\r\n  };\r\n\r\n  /**\r\n   * Gets priority display configuration\r\n   */\r\n  const getPriorityConfig = (priority) => {\r\n    const config = {\r\n      low: { label: 'Low', color: '#059669', icon: 'ðŸŸ¢' },\r\n      medium: { label: 'Medium', color: '#d97706', icon: 'ðŸŸ¡' },\r\n      high: { label: 'High', color: '#ea580c', icon: 'ðŸŸ ' },\r\n      critical: { label: 'Critical', color: '#dc2626', icon: 'ðŸ”´' }\r\n    };\r\n    return config[priority] || { label: priority, color: '#6b7280', icon: 'â“' };\r\n  };\r\n\r\n  /**\r\n   * Handles retry action\r\n   */\r\n  const handleRetry = () => {\r\n    setError(null);\r\n    fetchTicketData();\r\n  };\r\n\r\n  // Set up auto-refresh for ticket updates\r\n  useEffect(() => {\r\n    if (ticket && ['open', 'in-progress', 'pending'].includes(ticket.status)) {\r\n      refreshIntervalRef.current = setInterval(() => {\r\n        fetchTicketData();\r\n      }, 30000); // Refresh every 30 seconds for active tickets\r\n    }\r\n    \r\n    return () => {\r\n      if (refreshIntervalRef.current) {\r\n        clearInterval(refreshIntervalRef.current);\r\n      }\r\n    };\r\n  }, [ticket, fetchTicketData]);\r\n\r\n  // Initial data fetch\r\n  useEffect(() => {\r\n    // Check authentication\r\n    if (!isAuthenticated) {\r\n      navigate('/login', { \r\n        state: { from: `/tickets/${id}` },\r\n        replace: true \r\n      });\r\n      return;\r\n    }\r\n\r\n    // Validate ticket ID\r\n    if (!isValidTicketId(id)) {\r\n      console.error('Invalid ticket ID:', id);\r\n      setError({\r\n        message: 'Invalid ticket ID or ticket not found',\r\n        type: 'validation',\r\n        retryable: false,\r\n        action: () => navigate('/tickets')\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // Fetch data\r\n    fetchTicketData();\r\n\r\n    // Cleanup on unmount\r\n    return () => {\r\n      if (abortControllerRef.current) {\r\n        abortControllerRef.current.abort();\r\n      }\r\n      if (refreshIntervalRef.current) {\r\n        clearInterval(refreshIntervalRef.current);\r\n      }\r\n    };\r\n  }, [id, isAuthenticated, navigate, isValidTicketId, fetchTicketData]);\r\n\r\n  // Loading state\r\n  if (loading) {\r\n    return (\r\n      <>\r\n        <Navbar />\r\n        <div className=\"loading-container\">\r\n          <LoadingSpinner \r\n            message=\"Loading ticket details...\" \r\n            fullPage={true}\r\n            progress={true}\r\n          />\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n    // Error state (no ticket)\r\n  if (error && !ticket) {\r\n    const isBackToTicketsAction = error.action && \r\n      error.action.toString().includes('navigate') && \r\n      error.action.toString().includes('/tickets');\r\n    \r\n    return (\r\n      <>\r\n        <Navbar />\r\n        <div className=\"error-container\">\r\n          <div className=\"error-content\">\r\n            <div className=\"error-icon\">âŒ</div>\r\n            <h2>Unable to Load Ticket</h2>\r\n            <p className=\"error-message\">{error.message}</p>\r\n            <div className=\"error-actions\">\r\n              {error.retryable && (\r\n                <button \r\n                  onClick={handleRetry} \r\n                  className=\"btn btn-primary\"\r\n                  aria-label=\"Retry loading ticket\"\r\n                >\r\n                  Try Again\r\n                </button>\r\n              )}\r\n              {error.action ? (\r\n                <button \r\n                  onClick={error.action} \r\n                  className=\"btn btn-secondary\"\r\n                  aria-label={isBackToTicketsAction ? 'Back to tickets' : 'Take action'}\r\n                >\r\n                  {isBackToTicketsAction ? 'Back to Tickets' : 'Take Action'}\r\n                </button>\r\n              ) : (\r\n                <button \r\n                  onClick={() => navigate('/tickets')} \r\n                  className=\"btn btn-secondary\"\r\n                  aria-label=\"Back to tickets\"\r\n                >\r\n                  Back to Tickets\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  // No ticket found\r\n  if (!ticket) {\r\n    return (\r\n      <>\r\n        <Navbar />\r\n        <div className=\"not-found\">\r\n          <div className=\"not-found-content\">\r\n            <div className=\"not-found-icon\">ðŸ”</div>\r\n            <h2>Ticket Not Found</h2>\r\n            <p>The ticket you're looking for doesn't exist or has been deleted.</p>\r\n            <button \r\n              onClick={() => navigate('/tickets')} \r\n              className=\"btn btn-primary\"\r\n              aria-label=\"View all tickets\"\r\n            >\r\n              View All Tickets\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  // Check permissions\r\n  if (!hasPermission()) {\r\n    return (\r\n      <>\r\n        <Navbar />\r\n        <div className=\"permission-denied\">\r\n          <div className=\"permission-content\">\r\n            <div className=\"permission-icon\">ðŸš«</div>\r\n            <h2>Access Denied</h2>\r\n            <p>You do not have permission to view this ticket.</p>\r\n            <button \r\n              onClick={() => navigate('/tickets')} \r\n              className=\"btn btn-primary\"\r\n              aria-label=\"Back to tickets\"\r\n            >\r\n              Back to Tickets\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  const statusConfig = getStatusConfig(ticket.status);\r\n  const priorityConfig = getPriorityConfig(ticket.priority);\r\n  const slaStatus = getSLAStatus(ticket.slaDueDate, ticket.status);\r\n\r\n  return (\r\n    <ErrorBoundary>\r\n      <>\r\n        <Navbar />\r\n        <div className=\"ticket-detail-page\">\r\n          {/* Header Section */}\r\n          <header className=\"ticket-header\">\r\n            <div className=\"header-main\">\r\n              <div className=\"ticket-meta\">\r\n                <h1 className=\"ticket-title\">{ticket.title}</h1>\r\n                <div className=\"meta-tags\">\r\n                  <span className=\"ticket-id\">\r\n                    <strong>ID:</strong> {ticket.ticketId || `TKT-${ticket._id?.substring(0, 8).toUpperCase()}`}\r\n                  </span>\r\n                  <span \r\n                    className=\"status-badge\" \r\n                    style={{ backgroundColor: statusConfig.color }}\r\n                    aria-label={`Status: ${statusConfig.label}`}\r\n                  >\r\n                    <span className=\"status-icon\">{statusConfig.icon}</span>\r\n                    {statusConfig.label}\r\n                  </span>\r\n                  <span \r\n                    className=\"priority-badge\" \r\n                    style={{ backgroundColor: priorityConfig.color }}\r\n                    aria-label={`Priority: ${priorityConfig.label}`}\r\n                  >\r\n                    <span className=\"priority-icon\">{priorityConfig.icon}</span>\r\n                    {priorityConfig.label}\r\n                  </span>\r\n                  {ticket.slaDueDate && (\r\n                    <span className={`sla-badge sla-${slaStatus}`}>\r\n                      <span className=\"sla-icon\">\r\n                        {slaStatus === 'breached' ? 'â°' : \r\n                         slaStatus === 'critical' ? 'ðŸš¨' : \r\n                         slaStatus === 'warning' ? 'âš ï¸' : 'âœ…'}\r\n                      </span>\r\n                      SLA: {formatDate(ticket.slaDueDate)}\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"header-actions\">\r\n                {['admin', 'technician'].includes(user?.role) && (\r\n                  <div className=\"action-group\">\r\n                    {/* Status Update */}\r\n                    <select \r\n                      className=\"action-select status-select\"\r\n                      value={ticket.status}\r\n                      onChange={(e) => handleStatusUpdate(e.target.value)}\r\n                      disabled={updatingStatus}\r\n                      aria-label=\"Update ticket status\"\r\n                    >\r\n                      <option value=\"open\">Open</option>\r\n                      <option value=\"in-progress\">In Progress</option>\r\n                      <option value=\"pending\">Pending</option>\r\n                      <option value=\"resolved\">Resolved</option>\r\n                      <option value=\"closed\">Closed</option>\r\n                    </select>\r\n                    \r\n                    {/* Assignment */}\r\n                    <div className=\"assign-dropdown\">\r\n                      <button \r\n                        className=\"action-btn assign-btn\"\r\n                        onClick={() => setShowAssignDropdown(!showAssignDropdown)}\r\n                        disabled={assigningTicket}\r\n                        aria-label=\"Assign ticket\"\r\n                      >\r\n                        {assigningTicket ? 'Assigning...' : \r\n                         ticket.assignedTo ? 'Reassign' : 'Assign'}\r\n                      </button>\r\n                      \r\n                      {showAssignDropdown && (\r\n                        <div className=\"dropdown-menu\">\r\n                          <div className=\"dropdown-header\">\r\n                            <strong>Assign to:</strong>\r\n                          </div>\r\n                          {availableTechnicians.length > 0 ? (\r\n                            availableTechnicians.map(tech => (\r\n                              <button\r\n                                key={tech._id}\r\n                                className=\"dropdown-item\"\r\n                                onClick={() => handleAssignTicket(tech._id)}\r\n                                aria-label={`Assign to ${tech.name}`}\r\n                              >\r\n                                <span className=\"tech-name\">{tech.name}</span>\r\n                                <span className=\"tech-role\">{tech.role}</span>\r\n                              </button>\r\n                            ))\r\n                          ) : (\r\n                            <div className=\"dropdown-empty\">\r\n                              No technicians available\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                \r\n                <div className=\"action-group\">\r\n                  <button \r\n                    onClick={() => navigate('/tickets')} \r\n                    className=\"btn btn-secondary\"\r\n                    aria-label=\"Back to tickets list\"\r\n                  >\r\n                    â† Back to List\r\n                  </button>\r\n                  \r\n                  {lastUpdated && (\r\n                    <span className=\"last-updated\">\r\n                      Updated: {formatDate(lastUpdated)}\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </header>\r\n\r\n          {/* Error Display */}\r\n          {error && (\r\n            <div className={`alert alert-${error.type}`}>\r\n              <div className=\"alert-content\">\r\n                <strong>Error:</strong> {error.message}\r\n              </div>\r\n              <div className=\"alert-actions\">\r\n                {error.retryable && (\r\n                  <button onClick={handleRetry} className=\"btn btn-sm\">\r\n                    Retry\r\n                  </button>\r\n                )}\r\n                <button \r\n                  onClick={() => setError(null)} \r\n                  className=\"btn btn-sm btn-text\"\r\n                  aria-label=\"Dismiss error\"\r\n                >\r\n                  Dismiss\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Main Content */}\r\n          <main className=\"ticket-content\">\r\n            {/* Left Column: Ticket Details */}\r\n            <div className=\"ticket-main\">\r\n              {/* Description */}\r\n              <section className=\"ticket-description\" aria-label=\"Ticket description\">\r\n                <h2 className=\"section-title\">Description</h2>\r\n                <div className=\"description-content\">\r\n                  {ticket.description || 'No description provided.'}\r\n                </div>\r\n              </section>\r\n\r\n              {/* Ticket Information */}\r\n              <section className=\"ticket-info\" aria-label=\"Ticket information\">\r\n                <h2 className=\"section-title\">Ticket Information</h2>\r\n                <div className=\"info-grid\">\r\n                  <div className=\"info-item\">\r\n                    <span className=\"info-label\">Created</span>\r\n                    <span className=\"info-value\">{formatDate(ticket.createdAt)}</span>\r\n                  </div>\r\n                  <div className=\"info-item\">\r\n                    <span className=\"info-label\">Last Updated</span>\r\n                    <span className=\"info-value\">{formatDate(ticket.updatedAt)}</span>\r\n                  </div>\r\n                  <div className=\"info-item\">\r\n                    <span className=\"info-label\">Category</span>\r\n                    <span className=\"info-value\">{ticket.category || 'Not specified'}</span>\r\n                  </div>\r\n                  <div className=\"info-item\">\r\n                    <span className=\"info-label\">Sub Category</span>\r\n                    <span className=\"info-value\">{ticket.subCategory || 'Not specified'}</span>\r\n                  </div>\r\n                  <div className=\"info-item\">\r\n                    <span className=\"info-label\">Campus</span>\r\n                    <span className=\"info-value\">{ticket.campus || 'Not specified'}</span>\r\n                  </div>\r\n                  <div className=\"info-item\">\r\n                    <span className=\"info-label\">Location</span>\r\n                    <span className=\"info-value\">{ticket.location || 'Not specified'}</span>\r\n                  </div>\r\n                  {ticket.createdBy && (\r\n                    <div className=\"info-item\">\r\n                      <span className=\"info-label\">Created By</span>\r\n                      <div className=\"user-info\">\r\n                        <span className=\"user-name\">\r\n                          {ticket.createdBy.name || \r\n                           `${ticket.createdBy.firstName} ${ticket.createdBy.lastName}`}\r\n                        </span>\r\n                        <span className=\"user-email\">{ticket.createdBy.email}</span>\r\n                        <span className=\"user-role\">{ticket.createdBy.role}</span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {ticket.assignedTo && (\r\n                    <div className=\"info-item\">\r\n                      <span className=\"info-label\">Assigned To</span>\r\n                      <div className=\"user-info\">\r\n                        <span className=\"user-name\">\r\n                          {ticket.assignedTo.name || \r\n                           `${ticket.assignedTo.firstName} ${ticket.assignedTo.lastName}`}\r\n                        </span>\r\n                        <span className=\"user-email\">{ticket.assignedTo.email}</span>\r\n                        <span className=\"user-role\">{ticket.assignedTo.role}</span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {ticket.resolvedAt && (\r\n                    <div className=\"info-item\">\r\n                      <span className=\"info-label\">Resolved</span>\r\n                      <span className=\"info-value\">{formatDate(ticket.resolvedAt)}</span>\r\n                    </div>\r\n                  )}\r\n                  {ticket.closedAt && (\r\n                    <div className=\"info-item\">\r\n                      <span className=\"info-label\">Closed</span>\r\n                      <span className=\"info-value\">{formatDate(ticket.closedAt)}</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </section>\r\n\r\n              {/* Attachments */}\r\n              {(attachments.length > 0 || user?.role === 'technician' || user?.role === 'admin') && (\r\n                <section className=\"ticket-attachments\" aria-label=\"Ticket attachments\">\r\n                  <h2 className=\"section-title\">\r\n                    Attachments\r\n                    {['technician', 'admin'].includes(user?.role) && (\r\n                      <button \r\n                        className=\"btn-link\"\r\n                        onClick={() => fileInputRef.current?.click()}\r\n                        disabled={uploadingAttachment}\r\n                        aria-label=\"Add attachment\"\r\n                      >\r\n                        + Add\r\n                      </button>\r\n                    )}\r\n                  </h2>\r\n                  \r\n                  <input\r\n                    type=\"file\"\r\n                    ref={fileInputRef}\r\n                    onChange={handleFileUpload}\r\n                    multiple\r\n                    accept=\".jpg,.jpeg,.png,.gif,.pdf,.doc,.docx,.txt,.xls,.xlsx\"\r\n                    style={{ display: 'none' }}\r\n                    aria-label=\"Upload file\"\r\n                  />\r\n                  \r\n                  {uploadingAttachment && (\r\n                    <div className=\"uploading\">\r\n                      <LoadingSpinner message=\"Uploading...\" size=\"small\" />\r\n                    </div>\r\n                  )}\r\n                  \r\n                  {attachments.length > 0 ? (\r\n                    <div className=\"attachments-list\">\r\n                      {attachments.map((file, index) => (\r\n                        <div key={index} className=\"attachment-item\">\r\n                          <div className=\"attachment-icon\">\r\n                            {file.fileType?.startsWith('image/') ? 'ðŸ–¼ï¸' : \r\n                             file.fileType === 'application/pdf' ? 'ðŸ“„' : \r\n                             file.fileType?.includes('word') ? 'ðŸ“' : \r\n                             file.fileType?.includes('excel') ? 'ðŸ“Š' : 'ðŸ“Ž'}\r\n                          </div>\r\n                          <div className=\"attachment-info\">\r\n                            <a \r\n                              href={file.fileUrl} \r\n                              target=\"_blank\" \r\n                              rel=\"noopener noreferrer\"\r\n                              className=\"attachment-name\"\r\n                              aria-label={`Download ${file.fileName}`}\r\n                            >\r\n                              {file.fileName}\r\n                            </a>\r\n                            <span className=\"attachment-size\">\r\n                              {(file.fileSize / 1024).toFixed(1)} KB\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  ) : (\r\n                    <p className=\"no-attachments\">No attachments yet.</p>\r\n                  )}\r\n                </section>\r\n              )}\r\n            </div>\r\n\r\n            {/* Right Column: Activity & Comments */}\r\n            <div className=\"ticket-sidebar\">\r\n              {/* Comments Section */}\r\n              <section className=\"comments-section\" aria-label=\"Comments and activity\">\r\n                <h2 className=\"section-title\">Activity & Comments</h2>\r\n                \r\n                {/* Activities Timeline */}\r\n                {activities.length > 0 && (\r\n                  <div className=\"activities-timeline\">\r\n                    {activities.slice(0, 5).map((activity, index) => (\r\n                      <div key={index} className=\"activity-item\">\r\n                        <div className=\"activity-icon\">\r\n                          {activity.action === 'STATUS_UPDATE' ? 'ðŸ”„' :\r\n                           activity.action === 'ASSIGNED' ? 'ðŸ‘¤' :\r\n                           activity.action === 'COMMENT_ADDED' ? 'ðŸ’¬' : 'ðŸ“'}\r\n                        </div>\r\n                        <div className=\"activity-content\">\r\n                          <p className=\"activity-description\">{activity.description}</p>\r\n                          <div className=\"activity-meta\">\r\n                            <span className=\"activity-user\">{activity.user?.name}</span>\r\n                            <span className=\"activity-time\">{formatDate(activity.timestamp)}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n                \r\n                {/* Comments List */}\r\n                <div className=\"comments-list\">\r\n                  {comments.length === 0 ? (\r\n                    <div className=\"no-comments\">\r\n                      <p>No comments yet. Be the first to add one.</p>\r\n                    </div>\r\n                  ) : (\r\n                    comments.slice(0, 10).map((comment, index) => (\r\n                      <div \r\n                        key={comment._id || index} \r\n                        className={`comment-item ${comment.isInternal ? 'internal' : ''}`}\r\n                      >\r\n                        <div className=\"comment-header\">\r\n                          <div className=\"comment-author\">\r\n                            <span className=\"author-name\">\r\n                              {comment.user?.name || \r\n                               `${comment.user?.firstName} ${comment.user?.lastName}` ||\r\n                               'Unknown User'}\r\n                            </span>\r\n                            <span className=\"author-role\">{comment.user?.role}</span>\r\n                          </div>\r\n                          <div className=\"comment-meta\">\r\n                            <span className=\"comment-date\">{formatDate(comment.createdAt)}</span>\r\n                            {comment.isInternal && (\r\n                              <span className=\"internal-badge\" aria-label=\"Internal note\">\r\n                                Internal\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"comment-content\">\r\n                          {comment.message || comment.content}\r\n                        </div>\r\n                      </div>\r\n                    ))\r\n                  )}\r\n                </div>\r\n                \r\n                {/* Add Comment Form */}\r\n                <div className=\"add-comment\">\r\n                  <h3 className=\"form-title\">Add Comment</h3>\r\n                  <textarea\r\n                    value={newComment}\r\n                    onChange={(e) => setNewComment(e.target.value)}\r\n                    placeholder=\"Type your comment here...\"\r\n                    rows=\"4\"\r\n                    maxLength=\"2000\"\r\n                    aria-label=\"Comment text\"\r\n                    disabled={submittingComment}\r\n                  />\r\n                  \r\n                  <div className=\"comment-actions\">\r\n                    {['technician', 'admin'].includes(user?.role) && (\r\n                      <div className=\"internal-note-option\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          id=\"internal-note\"\r\n                          checked={isInternalNote}\r\n                          onChange={(e) => setIsInternalNote(e.target.checked)}\r\n                          aria-label=\"Mark as internal note\"\r\n                          disabled={submittingComment}\r\n                        />\r\n                        <label htmlFor=\"internal-note\">\r\n                          Internal note (staff only)\r\n                        </label>\r\n                      </div>\r\n                    )}\r\n                    \r\n                    <button\r\n                      onClick={handleAddComment}\r\n                      disabled={!newComment.trim() || submittingComment}\r\n                      className=\"btn btn-primary\"\r\n                      aria-label=\"Post comment\"\r\n                    >\r\n                      {submittingComment ? (\r\n                        <>\r\n                          <LoadingSpinner size=\"small\" />\r\n                          Posting...\r\n                        </>\r\n                      ) : (\r\n                        'Post Comment'\r\n                      )}\r\n                    </button>\r\n                  </div>\r\n                  \r\n                  <div className=\"comment-help\">\r\n                    <small>Comments can be marked as internal for staff communication only.</small>\r\n                  </div>\r\n                </div>\r\n              </section>\r\n            </div>\r\n          </main>\r\n\r\n          {/* Footer */}\r\n          <footer className=\"ticket-footer\">\r\n            <div className=\"footer-content\">\r\n              <div className=\"footer-info\">\r\n                <span className=\"ticket-age\">\r\n                  Ticket created {formatDate(ticket.createdAt)}\r\n                </span>\r\n                {ticket.slaDueDate && slaStatus !== 'completed' && (\r\n                  <span className={`sla-status sla-${slaStatus}`}>\r\n                    {slaStatus === 'breached' ? 'SLA Breached' :\r\n                     slaStatus === 'critical' ? 'SLA Critical' :\r\n                     slaStatus === 'warning' ? 'SLA Warning' : 'SLA On Track'}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              \r\n              <div className=\"footer-actions\">\r\n                <button \r\n                  onClick={fetchTicketData} \r\n                  className=\"btn btn-text\"\r\n                  aria-label=\"Refresh ticket data\"\r\n                >\r\n                  â†» Refresh\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </footer>\r\n        </div>\r\n      </>\r\n    </ErrorBoundary>\r\n  );\r\n};\r\n\r\nexport default TicketDetail;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}