{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\KADZ-TECH\\\\Documents\\\\dev\\\\it-support-system\\\\frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// frontend/src/context/AuthContext.js - PRODUCTION READY COMPLETE FIX\nimport React, { createContext, useState, useContext, useEffect, useCallback, useRef, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { authService } from '../services/authService';\n\n/**\r\n * Enterprise Auth Context v5.3.0 - COMPLETE PRODUCTION FIX\r\n * Fixed: logSecurityEvent properly exported in context\r\n * Fixed: No infinite re-render loops\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nclass AuthErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hasError: false,\n      error: null\n    };\n  }\n  static getDerivedStateFromError(error) {\n    return {\n      hasError: true,\n      error\n    };\n  }\n  componentDidCatch(error, errorInfo) {\n    console.error('Auth Error Boundary caught:', error, errorInfo);\n  }\n  render() {\n    if (this.state.hasError) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '40px',\n          textAlign: 'center',\n          backgroundColor: '#fef2f2',\n          borderRadius: '8px',\n          margin: '20px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            color: '#dc2626',\n            marginBottom: '16px'\n          },\n          children: \"Authentication Error\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: '#4b5563',\n            marginBottom: '24px'\n          },\n          children: \"Something went wrong with authentication. Please try refreshing the page.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => window.location.reload(),\n          style: {\n            padding: '10px 24px',\n            backgroundColor: '#3b82f6',\n            color: 'white',\n            border: 'none',\n            borderRadius: '6px',\n            cursor: 'pointer',\n            fontSize: '14px',\n            fontWeight: '500'\n          },\n          children: \"Refresh Page\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }, this);\n    }\n    return this.props.children;\n  }\n}\nconst createPerformanceMonitor = () => {\n  const metrics = {\n    loginTime: null,\n    refreshTime: null,\n    sessionChecks: 0,\n    errors: [],\n    securityEvents: []\n  };\n  return {\n    startMeasurement(operation) {\n      const startTime = performance.now();\n      return () => {\n        const duration = performance.now() - startTime;\n        metrics[operation] = duration;\n        if (duration > 1000 && process.env.NODE_ENV === 'development') {\n          console.warn(`Slow auth operation: ${operation} took ${duration.toFixed(2)}ms`);\n        }\n      };\n    },\n    logError(error, operation) {\n      metrics.errors.push({\n        operation,\n        error: error.message,\n        timestamp: new Date().toISOString()\n      });\n    },\n    logSecurityEvent(eventType, details) {\n      const event = {\n        eventType,\n        details,\n        timestamp: new Date().toISOString()\n      };\n      metrics.securityEvents.push(event);\n      return event;\n    },\n    getMetrics() {\n      return {\n        ...metrics\n      };\n    }\n  };\n};\n\n// Main AuthProvider Component\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [state, setState] = useState({\n    user: null,\n    session: null,\n    loading: true,\n    error: null,\n    success: null,\n    sessionExpiresAt: null,\n    permissions: new Set()\n  });\n  const refreshTimerRef = useRef(null);\n  const sessionCheckRef = useRef(null);\n  const activityTimerRef = useRef(null);\n  const isMountedRef = useRef(true);\n  const performanceMonitor = useMemo(() => createPerformanceMonitor(), []);\n  const stateRef = useRef(state);\n  useEffect(() => {\n    stateRef.current = state;\n  }, [state]);\n  const setAuthState = useCallback(updates => {\n    if (isMountedRef.current) {\n      setState(prev => ({\n        ...prev,\n        ...updates\n      }));\n    }\n  }, []);\n  const clearTimers = useCallback(() => {\n    [refreshTimerRef, sessionCheckRef, activityTimerRef].forEach(ref => {\n      if (ref.current) {\n        clearTimeout(ref.current);\n        ref.current = null;\n      }\n    });\n  }, []);\n\n  // CRITICAL: logSecurityEvent function - properly memoized and exported\n  const logSecurityEvent = useCallback((eventType, details) => {\n    const currentUser = stateRef.current.user;\n    const currentSession = stateRef.current.session;\n\n    // Log to performance monitor\n    performanceMonitor.logSecurityEvent(eventType, details);\n\n    // Prepare log data\n    const logData = {\n      eventType,\n      details,\n      timestamp: new Date().toISOString(),\n      userId: currentUser === null || currentUser === void 0 ? void 0 : currentUser.id,\n      userRole: currentUser === null || currentUser === void 0 ? void 0 : currentUser.role,\n      sessionId: currentSession === null || currentSession === void 0 ? void 0 : currentSession.id,\n      source: 'auth_context',\n      userAgent: navigator.userAgent,\n      url: window.location.href,\n      screenResolution: `${window.screen.width}x${window.screen.height}`,\n      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone\n    };\n\n    // Development logging (optional)\n    if (process.env.NODE_ENV === 'development') {\n      const importantEvents = ['login_failed', 'registration_failed', 'security_violation'];\n      if (importantEvents.includes(eventType)) {\n        console.log(`[SECURITY] ${eventType}:`, details);\n      }\n    }\n\n    // Production logging (non-blocking)\n    if (process.env.NODE_ENV === 'production') {\n      setTimeout(() => {\n        try {\n          fetch('/api/logs/security', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': currentSession !== null && currentSession !== void 0 && currentSession.accessToken ? `Bearer ${currentSession.accessToken}` : ''\n            },\n            body: JSON.stringify(logData)\n          }).catch(() => {});\n        } catch (error) {}\n      }, 0);\n    }\n    return logData;\n  }, [performanceMonitor]);\n  const scheduleTokenRefresh = useCallback(expiresAt => {\n    clearTimers();\n    if (!expiresAt) return;\n    const refreshTime = expiresAt - 5 * 60 * 1000 - Date.now();\n    if (refreshTime > 0) {\n      refreshTimerRef.current = setTimeout(async () => {\n        try {\n          const endMeasurement = performanceMonitor.startMeasurement('tokenRefresh');\n          await authService.refreshAccessToken();\n          endMeasurement();\n          const session = authService.getCurrentSession();\n          if (session) {\n            setAuthState({\n              session,\n              sessionExpiresAt: session.expiresAt\n            });\n            scheduleTokenRefresh(session.expiresAt);\n          }\n        } catch (error) {\n          performanceMonitor.logError(error, 'tokenRefresh');\n        }\n      }, Math.max(refreshTime, 0));\n    }\n  }, [clearTimers, performanceMonitor, setAuthState]);\n  const startSessionMonitoring = useCallback(expiresAt => {\n    clearTimers();\n    sessionCheckRef.current = setInterval(() => {\n      if (expiresAt && Date.now() > expiresAt) {\n        logout('session_expired');\n      }\n    }, 60 * 1000);\n    const trackActivity = () => {\n      if (activityTimerRef.current) clearTimeout(activityTimerRef.current);\n      activityTimerRef.current = setTimeout(() => logout('inactivity'), 30 * 60 * 1000);\n    };\n    ['mousemove', 'keydown', 'click', 'scroll'].forEach(event => {\n      window.addEventListener(event, trackActivity, {\n        passive: true\n      });\n    });\n    trackActivity();\n  }, [clearTimers]);\n  const initializeAuth = useCallback(async () => {\n    if (!isMountedRef.current) return;\n    try {\n      setAuthState({\n        loading: true,\n        error: null\n      });\n      const session = authService.getCurrentSession();\n      if (!session) {\n        setAuthState({\n          loading: false\n        });\n        return;\n      }\n      if (Date.now() > session.expiresAt) {\n        await logout('session_expired');\n        return;\n      }\n      const userResponse = await authService.getCurrentUser();\n      if (!userResponse.success) throw new Error('Failed to get user data');\n      const permissions = new Set(userResponse.data.permissions || []);\n      setAuthState({\n        user: userResponse.data,\n        session,\n        sessionExpiresAt: session.expiresAt,\n        permissions,\n        loading: false\n      });\n      logSecurityEvent('session_initialized', {\n        userId: userResponse.data.id,\n        role: userResponse.data.role,\n        sessionId: session.id,\n        sessionExpiresAt: new Date(session.expiresAt).toISOString()\n      });\n      scheduleTokenRefresh(session.expiresAt);\n      startSessionMonitoring(session.expiresAt);\n    } catch (error) {\n      performanceMonitor.logError(error, 'initializeAuth');\n      logSecurityEvent('initialization_failed', {\n        error: error.message\n      });\n      setAuthState({\n        error: 'Failed to initialize authentication',\n        loading: false\n      });\n    }\n  }, [setAuthState, scheduleTokenRefresh, performanceMonitor, logSecurityEvent]);\n  const login = useCallback(async (email, password, rememberMe = false) => {\n    try {\n      setAuthState({\n        loading: true,\n        error: null,\n        success: null\n      });\n      const endMeasurement = performanceMonitor.startMeasurement('login');\n      const response = await authService.login(email, password, rememberMe);\n      endMeasurement();\n      if (!response.success) throw new Error(response.message || 'Login failed');\n      const session = authService.getCurrentSession();\n      const permissions = new Set(response.data.user.permissions || []);\n      setAuthState({\n        user: response.data.user,\n        session,\n        sessionExpiresAt: session.expiresAt,\n        permissions,\n        loading: false,\n        success: 'Login successful'\n      });\n      logSecurityEvent('login_success', {\n        email,\n        rememberMe\n      });\n      scheduleTokenRefresh(session.expiresAt);\n      startSessionMonitoring(session.expiresAt);\n      return response;\n    } catch (error) {\n      performanceMonitor.logError(error, 'login');\n      logSecurityEvent('login_failed', {\n        email,\n        error: error.message\n      });\n      setAuthState({\n        error: error.message || 'Login failed',\n        loading: false\n      });\n      throw error;\n    }\n  }, [setAuthState, scheduleTokenRefresh, performanceMonitor, logSecurityEvent]);\n  const register = useCallback(async userData => {\n    try {\n      setAuthState({\n        loading: true,\n        error: null,\n        success: null\n      });\n      const endMeasurement = performanceMonitor.startMeasurement('register');\n      const response = await authService.register(userData);\n      endMeasurement();\n      if (!response.success) throw new Error(response.message || 'Registration failed');\n      logSecurityEvent('registration_attempt', {\n        email: userData.email,\n        role: userData.role\n      });\n      if (response.requiresVerification) {\n        setAuthState({\n          loading: false,\n          success: response.message\n        });\n        logSecurityEvent('registration_pending_verification', {\n          email: userData.email\n        });\n        return response;\n      }\n      const session = authService.getCurrentSession();\n      const permissions = new Set(response.data.user.permissions || []);\n      setAuthState({\n        user: response.data.user,\n        session,\n        sessionExpiresAt: session.expiresAt,\n        permissions,\n        loading: false,\n        success: response.message\n      });\n      logSecurityEvent('registration_success', {\n        email: userData.email,\n        role: userData.role\n      });\n      scheduleTokenRefresh(session.expiresAt);\n      startSessionMonitoring(session.expiresAt);\n      return response;\n    } catch (error) {\n      performanceMonitor.logError(error, 'register');\n      logSecurityEvent('registration_failed', {\n        email: userData.email,\n        error: error.message\n      });\n      setAuthState({\n        error: error.message || 'Registration failed',\n        loading: false\n      });\n      throw error;\n    }\n  }, [setAuthState, scheduleTokenRefresh, performanceMonitor, logSecurityEvent]);\n  const logout = useCallback(async (reason = 'user_action') => {\n    const currentUser = stateRef.current.user;\n    const currentSession = stateRef.current.session;\n    try {\n      logSecurityEvent('logout', {\n        reason,\n        userId: currentUser === null || currentUser === void 0 ? void 0 : currentUser.id\n      });\n      await authService.logout();\n    } catch (error) {\n      logSecurityEvent('logout_error', {\n        error: error.message,\n        reason\n      });\n    } finally {\n      clearTimers();\n      setAuthState({\n        user: null,\n        session: null,\n        sessionExpiresAt: null,\n        permissions: new Set(),\n        error: null,\n        success: null,\n        loading: false\n      });\n    }\n  }, [clearTimers, setAuthState, logSecurityEvent]);\n  const checkUsername = useCallback(async username => {\n    try {\n      const response = await authService.checkUsername(username);\n      logSecurityEvent('username_check', {\n        username,\n        available: response.available\n      });\n      return response;\n    } catch (error) {\n      logSecurityEvent('username_check_error', {\n        username,\n        error: error.message\n      });\n      return {\n        success: false,\n        available: false,\n        error: error.message\n      };\n    }\n  }, [logSecurityEvent]);\n  const checkEmail = useCallback(async email => {\n    try {\n      const response = await authService.checkEmail(email);\n      logSecurityEvent('email_check', {\n        email,\n        available: response.available\n      });\n      return response;\n    } catch (error) {\n      logSecurityEvent('email_check_error', {\n        email,\n        error: error.message\n      });\n      return {\n        success: false,\n        available: false,\n        error: error.message\n      };\n    }\n  }, [logSecurityEvent]);\n  const hasPermission = useCallback(permission => {\n    var _state$user;\n    return state.permissions.has(permission) || ((_state$user = state.user) === null || _state$user === void 0 ? void 0 : _state$user.role) === 'admin';\n  }, [state.permissions, state.user]);\n  const hasRole = useCallback(role => {\n    var _state$user2;\n    return ((_state$user2 = state.user) === null || _state$user2 === void 0 ? void 0 : _state$user2.role) === role;\n  }, [state.user]);\n  const hasAnyRole = useCallback(roles => {\n    var _state$user3;\n    return roles.includes((_state$user3 = state.user) === null || _state$user3 === void 0 ? void 0 : _state$user3.role);\n  }, [state.user]);\n  const clearError = useCallback(() => setAuthState({\n    error: null\n  }), [setAuthState]);\n  const clearSuccess = useCallback(() => setAuthState({\n    success: null\n  }), [setAuthState]);\n  useEffect(() => {\n    isMountedRef.current = true;\n    initializeAuth();\n    return () => {\n      isMountedRef.current = false;\n      clearTimers();\n    };\n  }, [initializeAuth, clearTimers]);\n\n  // CRITICAL: Include logSecurityEvent in context value\n  const contextValue = useMemo(() => ({\n    // State\n    user: state.user,\n    session: state.session,\n    loading: state.loading,\n    error: state.error,\n    success: state.success,\n    sessionExpiresAt: state.sessionExpiresAt,\n    // Auth methods\n    login,\n    register,\n    logout,\n    // Validation\n    checkUsername,\n    checkEmail,\n    // Permissions\n    hasPermission,\n    hasRole,\n    hasAnyRole,\n    isAuthenticated: !!state.user && !!state.session,\n    // SECURITY: This must be included\n    logSecurityEvent,\n    // Utilities\n    clearError,\n    clearSuccess\n  }), [state, login, register, logout, checkUsername, checkEmail, hasPermission, hasRole, hasAnyRole, logSecurityEvent,\n  // INCLUDED in dependencies\n  clearError, clearSuccess]);\n  return /*#__PURE__*/_jsxDEV(AuthErrorBoundary, {\n    children: /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n      value: contextValue,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 481,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 480,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"PyCo3XIFJOhuCuvZ9AGwQA6V/aI=\");\n_c = AuthProvider;\nAuthProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport default AuthContext;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","useCallback","useRef","useMemo","PropTypes","authService","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","context","Error","AuthErrorBoundary","Component","constructor","props","state","hasError","error","getDerivedStateFromError","componentDidCatch","errorInfo","console","render","style","padding","textAlign","backgroundColor","borderRadius","margin","children","color","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","onClick","window","location","reload","border","cursor","fontSize","fontWeight","createPerformanceMonitor","metrics","loginTime","refreshTime","sessionChecks","errors","securityEvents","startMeasurement","operation","startTime","performance","now","duration","process","env","NODE_ENV","warn","toFixed","logError","push","message","timestamp","Date","toISOString","logSecurityEvent","eventType","details","event","getMetrics","AuthProvider","_s2","setState","user","session","loading","success","sessionExpiresAt","permissions","Set","refreshTimerRef","sessionCheckRef","activityTimerRef","isMountedRef","performanceMonitor","stateRef","current","setAuthState","updates","prev","clearTimers","forEach","ref","clearTimeout","currentUser","currentSession","logData","userId","id","userRole","role","sessionId","source","userAgent","navigator","url","href","screenResolution","screen","width","height","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","importantEvents","includes","log","setTimeout","fetch","method","headers","accessToken","body","JSON","stringify","catch","scheduleTokenRefresh","expiresAt","endMeasurement","refreshAccessToken","getCurrentSession","Math","max","startSessionMonitoring","setInterval","logout","trackActivity","addEventListener","passive","initializeAuth","userResponse","getCurrentUser","data","login","email","password","rememberMe","response","register","userData","requiresVerification","reason","checkUsername","username","available","checkEmail","hasPermission","permission","_state$user","has","hasRole","_state$user2","hasAnyRole","roles","_state$user3","clearError","clearSuccess","contextValue","isAuthenticated","Provider","value","_c","propTypes","node","isRequired","$RefreshReg$"],"sources":["C:/Users/KADZ-TECH/Documents/dev/it-support-system/frontend/src/context/AuthContext.js"],"sourcesContent":["// frontend/src/context/AuthContext.js - PRODUCTION READY COMPLETE FIX\r\nimport React, { createContext, useState, useContext, useEffect, useCallback, useRef, useMemo } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { authService } from '../services/authService';\r\n\r\n/**\r\n * Enterprise Auth Context v5.3.0 - COMPLETE PRODUCTION FIX\r\n * Fixed: logSecurityEvent properly exported in context\r\n * Fixed: No infinite re-render loops\r\n */\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nclass AuthErrorBoundary extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { hasError: false, error: null };\r\n  }\r\n\r\n  static getDerivedStateFromError(error) {\r\n    return { hasError: true, error };\r\n  }\r\n\r\n  componentDidCatch(error, errorInfo) {\r\n    console.error('Auth Error Boundary caught:', error, errorInfo);\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return (\r\n        <div style={{\r\n          padding: '40px',\r\n          textAlign: 'center',\r\n          backgroundColor: '#fef2f2',\r\n          borderRadius: '8px',\r\n          margin: '20px'\r\n        }}>\r\n          <h3 style={{ color: '#dc2626', marginBottom: '16px' }}>Authentication Error</h3>\r\n          <p style={{ color: '#4b5563', marginBottom: '24px' }}>\r\n            Something went wrong with authentication. Please try refreshing the page.\r\n          </p>\r\n          <button\r\n            onClick={() => window.location.reload()}\r\n            style={{\r\n              padding: '10px 24px',\r\n              backgroundColor: '#3b82f6',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontSize: '14px',\r\n              fontWeight: '500'\r\n            }}\r\n          >\r\n            Refresh Page\r\n          </button>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nconst createPerformanceMonitor = () => {\r\n  const metrics = {\r\n    loginTime: null,\r\n    refreshTime: null,\r\n    sessionChecks: 0,\r\n    errors: [],\r\n    securityEvents: []\r\n  };\r\n\r\n  return {\r\n    startMeasurement(operation) {\r\n      const startTime = performance.now();\r\n      return () => {\r\n        const duration = performance.now() - startTime;\r\n        metrics[operation] = duration;\r\n        if (duration > 1000 && process.env.NODE_ENV === 'development') {\r\n          console.warn(`Slow auth operation: ${operation} took ${duration.toFixed(2)}ms`);\r\n        }\r\n      };\r\n    },\r\n\r\n    logError(error, operation) {\r\n      metrics.errors.push({ operation, error: error.message, timestamp: new Date().toISOString() });\r\n    },\r\n\r\n    logSecurityEvent(eventType, details) {\r\n      const event = { eventType, details, timestamp: new Date().toISOString() };\r\n      metrics.securityEvents.push(event);\r\n      return event;\r\n    },\r\n\r\n    getMetrics() {\r\n      return { ...metrics };\r\n    }\r\n  };\r\n};\r\n\r\n// Main AuthProvider Component\r\nexport const AuthProvider = ({ children }) => {\r\n  const [state, setState] = useState({\r\n    user: null,\r\n    session: null,\r\n    loading: true,\r\n    error: null,\r\n    success: null,\r\n    sessionExpiresAt: null,\r\n    permissions: new Set()\r\n  });\r\n\r\n  const refreshTimerRef = useRef(null);\r\n  const sessionCheckRef = useRef(null);\r\n  const activityTimerRef = useRef(null);\r\n  const isMountedRef = useRef(true);\r\n  const performanceMonitor = useMemo(() => createPerformanceMonitor(), []);\r\n  const stateRef = useRef(state);\r\n\r\n  useEffect(() => {\r\n    stateRef.current = state;\r\n  }, [state]);\r\n\r\n  const setAuthState = useCallback((updates) => {\r\n    if (isMountedRef.current) {\r\n      setState(prev => ({ ...prev, ...updates }));\r\n    }\r\n  }, []);\r\n\r\n  const clearTimers = useCallback(() => {\r\n    [refreshTimerRef, sessionCheckRef, activityTimerRef].forEach(ref => {\r\n      if (ref.current) {\r\n        clearTimeout(ref.current);\r\n        ref.current = null;\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  // CRITICAL: logSecurityEvent function - properly memoized and exported\r\n  const logSecurityEvent = useCallback((eventType, details) => {\r\n    const currentUser = stateRef.current.user;\r\n    const currentSession = stateRef.current.session;\r\n    \r\n    // Log to performance monitor\r\n    performanceMonitor.logSecurityEvent(eventType, details);\r\n    \r\n    // Prepare log data\r\n    const logData = {\r\n      eventType,\r\n      details,\r\n      timestamp: new Date().toISOString(),\r\n      userId: currentUser?.id,\r\n      userRole: currentUser?.role,\r\n      sessionId: currentSession?.id,\r\n      source: 'auth_context',\r\n      userAgent: navigator.userAgent,\r\n      url: window.location.href,\r\n      screenResolution: `${window.screen.width}x${window.screen.height}`,\r\n      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone\r\n    };\r\n    \r\n    // Development logging (optional)\r\n    if (process.env.NODE_ENV === 'development') {\r\n      const importantEvents = ['login_failed', 'registration_failed', 'security_violation'];\r\n      if (importantEvents.includes(eventType)) {\r\n        console.log(`[SECURITY] ${eventType}:`, details);\r\n      }\r\n    }\r\n    \r\n    // Production logging (non-blocking)\r\n    if (process.env.NODE_ENV === 'production') {\r\n      setTimeout(() => {\r\n        try {\r\n          fetch('/api/logs/security', {\r\n            method: 'POST',\r\n            headers: { \r\n              'Content-Type': 'application/json',\r\n              'Authorization': currentSession?.accessToken ? `Bearer ${currentSession.accessToken}` : ''\r\n            },\r\n            body: JSON.stringify(logData)\r\n          }).catch(() => {});\r\n        } catch (error) {}\r\n      }, 0);\r\n    }\r\n    \r\n    return logData;\r\n  }, [performanceMonitor]);\r\n\r\n  const scheduleTokenRefresh = useCallback((expiresAt) => {\r\n    clearTimers();\r\n    if (!expiresAt) return;\r\n\r\n    const refreshTime = expiresAt - (5 * 60 * 1000) - Date.now();\r\n    if (refreshTime > 0) {\r\n      refreshTimerRef.current = setTimeout(async () => {\r\n        try {\r\n          const endMeasurement = performanceMonitor.startMeasurement('tokenRefresh');\r\n          await authService.refreshAccessToken();\r\n          endMeasurement();\r\n          \r\n          const session = authService.getCurrentSession();\r\n          if (session) {\r\n            setAuthState({ session, sessionExpiresAt: session.expiresAt });\r\n            scheduleTokenRefresh(session.expiresAt);\r\n          }\r\n        } catch (error) {\r\n          performanceMonitor.logError(error, 'tokenRefresh');\r\n        }\r\n      }, Math.max(refreshTime, 0));\r\n    }\r\n  }, [clearTimers, performanceMonitor, setAuthState]);\r\n\r\n  const startSessionMonitoring = useCallback((expiresAt) => {\r\n    clearTimers();\r\n    \r\n    sessionCheckRef.current = setInterval(() => {\r\n      if (expiresAt && Date.now() > expiresAt) {\r\n        logout('session_expired');\r\n      }\r\n    }, 60 * 1000);\r\n\r\n    const trackActivity = () => {\r\n      if (activityTimerRef.current) clearTimeout(activityTimerRef.current);\r\n      activityTimerRef.current = setTimeout(() => logout('inactivity'), 30 * 60 * 1000);\r\n    };\r\n\r\n    ['mousemove', 'keydown', 'click', 'scroll'].forEach(event => {\r\n      window.addEventListener(event, trackActivity, { passive: true });\r\n    });\r\n\r\n    trackActivity();\r\n  }, [clearTimers]);\r\n\r\n  const initializeAuth = useCallback(async () => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    try {\r\n      setAuthState({ loading: true, error: null });\r\n      const session = authService.getCurrentSession();\r\n      \r\n      if (!session) {\r\n        setAuthState({ loading: false });\r\n        return;\r\n      }\r\n\r\n      if (Date.now() > session.expiresAt) {\r\n        await logout('session_expired');\r\n        return;\r\n      }\r\n\r\n      const userResponse = await authService.getCurrentUser();\r\n      if (!userResponse.success) throw new Error('Failed to get user data');\r\n\r\n      const permissions = new Set(userResponse.data.permissions || []);\r\n      setAuthState({\r\n        user: userResponse.data,\r\n        session,\r\n        sessionExpiresAt: session.expiresAt,\r\n        permissions,\r\n        loading: false\r\n      });\r\n\r\n      logSecurityEvent('session_initialized', {\r\n        userId: userResponse.data.id,\r\n        role: userResponse.data.role,\r\n        sessionId: session.id,\r\n        sessionExpiresAt: new Date(session.expiresAt).toISOString()\r\n      });\r\n\r\n      scheduleTokenRefresh(session.expiresAt);\r\n      startSessionMonitoring(session.expiresAt);\r\n\r\n    } catch (error) {\r\n      performanceMonitor.logError(error, 'initializeAuth');\r\n      logSecurityEvent('initialization_failed', { error: error.message });\r\n      setAuthState({ error: 'Failed to initialize authentication', loading: false });\r\n    }\r\n  }, [setAuthState, scheduleTokenRefresh, performanceMonitor, logSecurityEvent]);\r\n\r\n  const login = useCallback(async (email, password, rememberMe = false) => {\r\n    try {\r\n      setAuthState({ loading: true, error: null, success: null });\r\n      \r\n      const endMeasurement = performanceMonitor.startMeasurement('login');\r\n      const response = await authService.login(email, password, rememberMe);\r\n      endMeasurement();\r\n\r\n      if (!response.success) throw new Error(response.message || 'Login failed');\r\n\r\n      const session = authService.getCurrentSession();\r\n      const permissions = new Set(response.data.user.permissions || []);\r\n\r\n      setAuthState({\r\n        user: response.data.user,\r\n        session,\r\n        sessionExpiresAt: session.expiresAt,\r\n        permissions,\r\n        loading: false,\r\n        success: 'Login successful'\r\n      });\r\n\r\n      logSecurityEvent('login_success', { email, rememberMe });\r\n      scheduleTokenRefresh(session.expiresAt);\r\n      startSessionMonitoring(session.expiresAt);\r\n\r\n      return response;\r\n\r\n    } catch (error) {\r\n      performanceMonitor.logError(error, 'login');\r\n      logSecurityEvent('login_failed', { email, error: error.message });\r\n      setAuthState({ error: error.message || 'Login failed', loading: false });\r\n      throw error;\r\n    }\r\n  }, [setAuthState, scheduleTokenRefresh, performanceMonitor, logSecurityEvent]);\r\n\r\n  const register = useCallback(async (userData) => {\r\n    try {\r\n      setAuthState({ loading: true, error: null, success: null });\r\n      \r\n      const endMeasurement = performanceMonitor.startMeasurement('register');\r\n      const response = await authService.register(userData);\r\n      endMeasurement();\r\n\r\n      if (!response.success) throw new Error(response.message || 'Registration failed');\r\n\r\n      logSecurityEvent('registration_attempt', { email: userData.email, role: userData.role });\r\n\r\n      if (response.requiresVerification) {\r\n        setAuthState({ loading: false, success: response.message });\r\n        logSecurityEvent('registration_pending_verification', { email: userData.email });\r\n        return response;\r\n      }\r\n\r\n      const session = authService.getCurrentSession();\r\n      const permissions = new Set(response.data.user.permissions || []);\r\n\r\n      setAuthState({\r\n        user: response.data.user,\r\n        session,\r\n        sessionExpiresAt: session.expiresAt,\r\n        permissions,\r\n        loading: false,\r\n        success: response.message\r\n      });\r\n\r\n      logSecurityEvent('registration_success', { email: userData.email, role: userData.role });\r\n      scheduleTokenRefresh(session.expiresAt);\r\n      startSessionMonitoring(session.expiresAt);\r\n\r\n      return response;\r\n\r\n    } catch (error) {\r\n      performanceMonitor.logError(error, 'register');\r\n      logSecurityEvent('registration_failed', { email: userData.email, error: error.message });\r\n      setAuthState({ error: error.message || 'Registration failed', loading: false });\r\n      throw error;\r\n    }\r\n  }, [setAuthState, scheduleTokenRefresh, performanceMonitor, logSecurityEvent]);\r\n\r\n  const logout = useCallback(async (reason = 'user_action') => {\r\n    const currentUser = stateRef.current.user;\r\n    const currentSession = stateRef.current.session;\r\n    \r\n    try {\r\n      logSecurityEvent('logout', { reason, userId: currentUser?.id });\r\n      await authService.logout();\r\n    } catch (error) {\r\n      logSecurityEvent('logout_error', { error: error.message, reason });\r\n    } finally {\r\n      clearTimers();\r\n      setAuthState({\r\n        user: null,\r\n        session: null,\r\n        sessionExpiresAt: null,\r\n        permissions: new Set(),\r\n        error: null,\r\n        success: null,\r\n        loading: false\r\n      });\r\n    }\r\n  }, [clearTimers, setAuthState, logSecurityEvent]);\r\n\r\n  const checkUsername = useCallback(async (username) => {\r\n    try {\r\n      const response = await authService.checkUsername(username);\r\n      logSecurityEvent('username_check', { username, available: response.available });\r\n      return response;\r\n    } catch (error) {\r\n      logSecurityEvent('username_check_error', { username, error: error.message });\r\n      return { success: false, available: false, error: error.message };\r\n    }\r\n  }, [logSecurityEvent]);\r\n\r\n  const checkEmail = useCallback(async (email) => {\r\n    try {\r\n      const response = await authService.checkEmail(email);\r\n      logSecurityEvent('email_check', { email, available: response.available });\r\n      return response;\r\n    } catch (error) {\r\n      logSecurityEvent('email_check_error', { email, error: error.message });\r\n      return { success: false, available: false, error: error.message };\r\n    }\r\n  }, [logSecurityEvent]);\r\n\r\n  const hasPermission = useCallback((permission) => {\r\n    return state.permissions.has(permission) || state.user?.role === 'admin';\r\n  }, [state.permissions, state.user]);\r\n\r\n  const hasRole = useCallback((role) => state.user?.role === role, [state.user]);\r\n  const hasAnyRole = useCallback((roles) => roles.includes(state.user?.role), [state.user]);\r\n  const clearError = useCallback(() => setAuthState({ error: null }), [setAuthState]);\r\n  const clearSuccess = useCallback(() => setAuthState({ success: null }), [setAuthState]);\r\n\r\n  useEffect(() => {\r\n    isMountedRef.current = true;\r\n    initializeAuth();\r\n\r\n    return () => {\r\n      isMountedRef.current = false;\r\n      clearTimers();\r\n    };\r\n  }, [initializeAuth, clearTimers]);\r\n\r\n  // CRITICAL: Include logSecurityEvent in context value\r\n  const contextValue = useMemo(() => ({\r\n    // State\r\n    user: state.user,\r\n    session: state.session,\r\n    loading: state.loading,\r\n    error: state.error,\r\n    success: state.success,\r\n    sessionExpiresAt: state.sessionExpiresAt,\r\n    \r\n    // Auth methods\r\n    login,\r\n    register,\r\n    logout,\r\n    \r\n    // Validation\r\n    checkUsername,\r\n    checkEmail,\r\n    \r\n    // Permissions\r\n    hasPermission,\r\n    hasRole,\r\n    hasAnyRole,\r\n    isAuthenticated: !!state.user && !!state.session,\r\n    \r\n    // SECURITY: This must be included\r\n    logSecurityEvent,\r\n    \r\n    // Utilities\r\n    clearError,\r\n    clearSuccess\r\n  }), [\r\n    state,\r\n    login,\r\n    register,\r\n    logout,\r\n    checkUsername,\r\n    checkEmail,\r\n    hasPermission,\r\n    hasRole,\r\n    hasAnyRole,\r\n    logSecurityEvent, // INCLUDED in dependencies\r\n    clearError,\r\n    clearSuccess\r\n  ]);\r\n\r\n  return (\r\n    <AuthErrorBoundary>\r\n      <AuthContext.Provider value={contextValue}>\r\n        {children}\r\n      </AuthContext.Provider>\r\n    </AuthErrorBoundary>\r\n  );\r\n};\r\n\r\nAuthProvider.propTypes = {\r\n  children: PropTypes.node.isRequired\r\n};\r\n\r\nexport default AuthContext;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}